[('Space_file', [('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-105/ses-1/beh/sub-105_ses-1_task-space_events.tsv', '16df73bed667068625f50a77afca23d7'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-089/ses-1/beh/sub-089_ses-1_task-space_events.tsv', 'c7b575954b0f3a93e2d5d186d7a2089e'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-039/ses-1/beh/sub-039_ses-1_task-space_events.tsv', '77f17179d82087d6565640cda7f1e3de'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-080/ses-1/beh/sub-080_ses-1_task-space_events.tsv', 'e8400b23706c97b1d8fc3af7ee61eb88'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-103/ses-1/beh/sub-103_ses-1_task-space_events.tsv', 'dd02fe3ef1e5515141af53a9f2ef2e92'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-077/ses-1/beh/sub-077_ses-1_task-space_events.tsv', '8d294e5e513cf433abaa3781cfcf21da'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-098/ses-1/beh/sub-098_ses-1_task-space_events.tsv', 'db16f25e0c1ee1dfcb7038ff4ef2e175'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-120/ses-1/beh/sub-120_ses-1_task-space_events.tsv', 'afb23272283ec31640064baf22af87fa'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-045/ses-1/beh/sub-045_ses-1_task-space_events.tsv', 'dd5cbc7cc00f2293ccd4a8f07eed0c8f'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-056/ses-1/beh/sub-056_ses-1_task-space_events.tsv', '3d75d203e69077e383c6a29b37699f9d'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-048/ses-1/beh/sub-048_ses-1_task-space_events.tsv', '723437f54372873738fb0b0587a9a564'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-073/ses-1/beh/sub-073_ses-1_task-space_events.tsv', '369f01a7e72942aa1b3947d768ef03a9'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-074/ses-1/beh/sub-074_ses-1_task-space_events.tsv', 'ae16ae94f2591cf2472812c08b13e75d'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-054/ses-1/beh/sub-054_ses-1_task-space_events.tsv', '23640c8323c93dae493d579b1f38b040'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-090/ses-1/beh/sub-090_ses-1_task-space_events.tsv', '87e06f6d18eca350594616fb50170504'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-075/ses-1/beh/sub-075_ses-1_task-space_events.tsv', '9aefc1efd3660622db650502354fa854'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-112/ses-1/beh/sub-112_ses-1_task-space_events.tsv', 'bda1229ac1fc8bcb7b9d0dc1260467ff'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-041/ses-1/beh/sub-041_ses-1_task-space_events.tsv', '05481ad0e6c936dbf6daba96925d683f'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-113/ses-1/beh/sub-113_ses-1_task-space_events.tsv', 'c9d3b07656655a8008153308e2271d54'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-095/ses-1/beh/sub-095_ses-1_task-space_events.tsv', 'fe375e87f9c6bc09b32f942eb05bacf5'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-084/ses-1/beh/sub-084_ses-1_task-space_events.tsv', 'e0e8ec72d19deb76cb385a8fb36f0208'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-106/ses-1/beh/sub-106_ses-1_task-space_events.tsv', 'cf14d80d1cd47626159fd0c3115084d7'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-057/ses-1/beh/sub-057_ses-1_task-space_events.tsv', '1ecf2cf5d80545e5b33b2ed5427e1687'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-072/ses-1/beh/sub-072_ses-1_task-space_events.tsv', '44b5e7bb3d5173c56de13d5f9fe2b48f'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-111/ses-1/beh/sub-111_ses-1_task-space_events.tsv', 'a16e8466aa0ce0b478374f23d15e345b'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-119/ses-1/beh/sub-119_ses-1_task-space_events.tsv', '68138e91567a21d2c9461e9ccc8501a7'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-117/ses-1/beh/sub-117_ses-1_task-space_events.tsv', '0f20362ab5bfbe31b4096962527ecdd8'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-055/ses-1/beh/sub-055_ses-1_task-space_events.tsv', '2b5aa577a5c31385da2939b97377a7dc'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-047/ses-1/beh/sub-047_ses-1_task-space_events.tsv', 'feddbb9a153695de76c27ef3ec04c10d'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-021/ses-1/beh/sub-021_ses-1_task-space_events.tsv', '3e9a5439d679f51e97dae7bf3890f68f'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-121/ses-1/beh/sub-121_ses-1_task-space_events.tsv', '4baabb68d1dd463c2e768b9e9dde053d'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-071/ses-1/beh/sub-071_ses-1_task-space_events.tsv', '376b4d0f3aa0e299efd517c28b722b14'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-093/ses-1/beh/sub-093_ses-1_task-space_events.tsv', 'cf092f2f3f07e6d9e635e3c80d4fb194'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-104/ses-1/beh/sub-104_ses-1_task-space_events.tsv', 'c092d0ebbc265844e18b2eaa5ee077dd'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-116/ses-1/beh/sub-116_ses-1_task-space_events.tsv', 'b1ba45fbf0ced5094f930280d2f82e06'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-052/ses-1/beh/sub-052_ses-1_task-space_events.tsv', '986c015d0a75846832155966a5ecfa67'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-078/ses-1/beh/sub-078_ses-1_task-space_events.tsv', '71b2a0487eb70d7de1bc5eb28ef63db1'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-083/ses-1/beh/sub-083_ses-1_task-space_events.tsv', '283943c08ae74010717cbf03d54caa80'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-069/ses-1/beh/sub-069_ses-1_task-space_events.tsv', 'f097a921cb01c584b80d8a69c3496676'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-070/ses-1/beh/sub-070_ses-1_task-space_events.tsv', 'ee1c70bf3aacb93aa68b617301bc9a68'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-107/ses-1/beh/sub-107_ses-1_task-space_events.tsv', '7b88f96f6cfb75f916cb7bfed2b559b7'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-051/ses-1/beh/sub-051_ses-1_task-space_events.tsv', '9cce5e441860c58b3496815c9a78fadd'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-068/ses-1/beh/sub-068_ses-1_task-space_events.tsv', 'ea781de5afa1cb27153d113645978732'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-118/ses-1/beh/sub-118_ses-1_task-space_events.tsv', '977dd4561c3da7abae58828463d5f781'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-096/ses-1/beh/sub-096_ses-1_task-space_events.tsv', 'b1a43c1844b0e19fa61726e23eb99cf4'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-101/ses-1/beh/sub-101_ses-1_task-space_events.tsv', '6129c16128ad67ecbba4ccc03b58a353'), ('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-049/ses-1/beh/sub-049_ses-1_task-space_events.tsv', '2f556147fc4b77ec4cc6ba63ff9a92d8')]), ('base_directory', PosixPath('/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat')), ('function_str', "def summarySpace(Space_file, base_directory):\n    import numpy as np\n    import pandas as pd\n    import scipy.io as sio\n    from pathlib import Path\n\n    ###################################################################\n    ####                   Sub-function script                     ####\n\n    #need to sub-functions within the function that is called by the node just \n    #like you need to re-import libraries\n    def summary_stats(Space_data):\n\n        #Earth RT\n        earthRT_mean = Space_data.loc[Space_data['rt_earth'] > 0, 'rt_earth'].mean(axis = 0)*1000  \n        earthRT_median = Space_data.loc[Space_data['rt_earth'] > 0, 'rt_earth'].median(axis = 0)*1000  \n\n        #Earth missed\n        earth_n_miss = Space_data['missed_earth'].sum(axis = 0)\n        earth_p_miss = Space_data['missed_earth'].sum(axis = 0)/Space_data['missed_earth'].shape[0]\n\n        #Planet RT\n        planetRT_mean = Space_data.loc[Space_data['rt_planet'] > 0, 'rt_planet'].mean(axis = 0)*1000  \n        planetRT_median = Space_data.loc[Space_data['rt_planet'] > 0, 'rt_planet'].median(axis = 0)*1000  \n\n        #Planet missed\n        planet_n_miss = Space_data['missed_planet'].sum(axis = 0)\n        planet_p_miss = Space_data['missed_planet'].sum(axis = 0)/Space_data['missed_planet'].shape[0]\n\n        #reward rate\n        reward_rate = Space_data.loc[(Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'points'].mean(axis = 0)\n\n        #average reward overall across both options\n        rewards = Space_data[['rewards1', 'rewards2']].values.tolist()\n        rewards_flat = [item for sublist in rewards for item in sublist]\n        avg_reward = sum(rewards_flat)/len(rewards_flat)\n\n        #corrected reward rate\n        reward_rate_corrected = reward_rate - avg_reward\n\n        #stay probabilities (always won previously as no negatives) for if\n        #earth state is same or different\n        prob_sameplanet_earthsame = Space_data.loc[(Space_data['same_earth'] == 1) & (Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'same_planet'].mean(axis = 0)\n        prob_sameplanet_earthdif = Space_data.loc[(Space_data['same_earth'] == 0) & (Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'same_planet'].mean(axis = 0)\n\n        summary_results = [earthRT_mean, earthRT_median, earth_n_miss, earth_p_miss, planetRT_mean, planetRT_median, \n                            planet_n_miss, planet_p_miss, reward_rate, avg_reward, reward_rate_corrected, \n                            prob_sameplanet_earthsame, prob_sameplanet_earthdif]\n\n        return(summary_results)\n\n    ###################################################################\n    ####                Primary function script                    ####\n\n    #summary column names\n    colnames = ['sub', 'ses', 'block', 'earth_rt_mean', 'earth_rt_median', 'earth_n_miss', 'earth_p_miss', 'planet_rt_mean', \n                'planet_rt_median', 'planet_n_miss', 'planet_p_miss', 'reward_rate', 'avg_reward', \n                'reward_rate_corrected', 'prob_sameplanet_earthsame', 'prob_sameplanet_earthdif']\n\n    #check if str\n    if isinstance(Space_file, str):\n\n        #check to see if it is filepath str or 'No subfiles' message\n        if '.tsv' in Space_file:\n            #if only 1 file, will be string and we want an array\n            Space_file = [Space_file]\n        else:\n            Space_file = []\n\n    if len(Space_file) > 0:\n\n        #loop counter\n        count = 0\n\n        #supress warning\n        pd.options.mode.chained_assignment = None\n\n        for file in Space_file:\n\n            #load data \n            Space_ProcData = pd.read_csv(str(file), sep = '\\t', encoding = 'utf-8-sig', engine='python') \n\n            #add previous trial data\n            Space_ProcData['prev_state_earth'] = Space_ProcData['state_earth'].shift(1)\n            Space_ProcData['prev_state_earth'] = np.where(np.isnan(Space_ProcData['prev_state_earth']), 0, Space_ProcData['prev_state_earth'])\n\n            Space_ProcData['prev_state_planet'] = Space_ProcData['state_planet'].shift(1)\n            Space_ProcData['prev_state_planet'] = np.where(np.isnan(Space_ProcData['prev_state_planet']), 0, Space_ProcData['prev_state_planet'])\n\n            Space_ProcData['same_earth'] = np.where(Space_ProcData['state_earth'] == Space_ProcData['prev_state_earth'], 1, 0)\n            Space_ProcData['same_planet'] = np.where(Space_ProcData['state_planet'] == Space_ProcData['prev_state_planet'], 1, 0)\n\n            #summary stats - across all blocks\n            all_trials_stat = summary_stats(Space_ProcData)\n            all_trials_stat.insert(0, Space_ProcData.loc[0, 'sub'])\n            all_trials_stat.insert(1, Space_ProcData.loc[0, 'ses'])\n            all_trials_stat.insert(2, 'all')\n\n            if count == 0:\n                #make summary dataset\n                overall_summary_data = pd.DataFrame(all_trials_stat).T\n                overall_summary_data.columns = colnames\n\n                #make group_trailsdat dataset\n                space_group_trialsdat = Space_ProcData\n            else:\n                #add to summary dataset\n                overall_summary_data.loc[len(overall_summary_data)] = all_trials_stat\n\n                #add to group_trailsdat dataset\n                space_group_trialsdat = Space_ProcData\n                space_group_trialsdat = pd.concat([space_group_trialsdat, Space_ProcData],ignore_index=True)\n\n            # summary stats - by block \n            for b in np.unique(Space_ProcData['block']):\n                #get block data\n                block_data = Space_ProcData.loc[Space_ProcData['block'] == b]\n\n                #re-do previous trial data base on just current block\n                block_data['prev_state_earth'] = block_data['state_earth'].shift(1)\n                block_data['prev_state_earth'] = np.where(np.isnan(block_data['prev_state_earth']), 0, block_data['prev_state_earth'])\n\n                block_data['prev_state_planet'] = block_data['state_planet'].shift(1)\n                block_data['prev_state_planet'] = np.where(np.isnan(block_data['prev_state_planet']), 0, block_data['prev_state_planet'])\n\n                block_data['same_earth'] = np.where(block_data['state_earth'] == block_data['prev_state_earth'], 1, 0)\n                block_data['same_planet'] = np.where(block_data['state_planet'] == block_data['prev_state_planet'], 1, 0)\n\n                #get summary results\n                block_trials_stat = summary_stats(block_data)\n                block_trials_stat.insert(0, Space_ProcData.loc[0, 'sub'])\n                block_trials_stat.insert(1, Space_ProcData.loc[0, 'ses'])\n\n                block_name = 'b' + str(b)\n                block_trials_stat.insert(2, block_name)\n\n                #append new rows\n                overall_summary_data.loc[len(overall_summary_data)] = block_trials_stat\n\n            #update count for files loop\n            count = 1\n\n    else:\n         overall_summary_data = 'no files'\n\n    return overall_summary_data, space_group_trialsdat\n"), ('needed_outputs', ['group_trialdat', 'summarySpace_dat'])]