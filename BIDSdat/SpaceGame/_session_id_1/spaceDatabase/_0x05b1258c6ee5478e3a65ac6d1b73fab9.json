[('Space_group_trialdat', [    sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   105    1      1  ...                0.0           0            0
1   105    1      1  ...                2.0           1            0
2   105    1      1  ...                1.0           1            0
3   105    1      1  ...                2.0           0            1
4   105    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95  105    1      4  ...                2.0           0            1
96  105    1      4  ...                2.0           0            0
97  105    1      4  ...                1.0           0            1
98  105    1      4  ...                1.0           1            1
99  105    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    89    1      1  ...                0.0           0            0
1    89    1      1  ...                2.0           0            1
2    89    1      1  ...                2.0           0            0
3    89    1      1  ...                1.0           0            0
4    89    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   89    1      4  ...                2.0           0            1
96   89    1      4  ...                2.0           1            1
97   89    1      4  ...                2.0           1            1
98   89    1      4  ...                2.0           1            1
99   89    1      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    39    1      1  ...                0.0           0            0
1    39    1      1  ...                2.0           1            0
2    39    1      1  ...                1.0           1            1
3    39    1      1  ...                1.0           0            1
4    39    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   39    1      4  ...                2.0           0            0
96   39    1      4  ...                1.0           1            0
97   39    1      4  ...                2.0           0            0
98   39    1      4  ...                1.0           1            1
99   39    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    80    1      1  ...                0.0           0            0
1    80    1      1  ...                2.0           1            1
2    80    1      1  ...                2.0           1            0
3    80    1      1  ...                1.0           0            1
4    80    1      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   80    1      4  ...                2.0           1            1
96   80    1      4  ...                2.0           1            1
97   80    1      4  ...                2.0           0            1
98   80    1      4  ...                2.0           1            1
99   80    1      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   103    1      1  ...                0.0           0            0
1   103    1      1  ...                2.0           0            1
2   103    1      1  ...                2.0           1            0
3   103    1      1  ...                1.0           1            1
4   103    1      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95  103    1      4  ...                2.0           0            1
96  103    1      4  ...                2.0           0            0
97  103    1      4  ...                0.0           1            0
98  103    1      4  ...                1.0           0            1
99  103    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    77    1      1  ...                0.0           0            0
1    77    1      1  ...                2.0           0            1
2    77    1      1  ...                2.0           1            0
3    77    1      1  ...                1.0           0            1
4    77    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   77    1      4  ...                2.0           1            1
96   77    1      4  ...                2.0           0            0
97   77    1      4  ...                1.0           1            1
98   77    1      4  ...                1.0           0            1
99   77    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    98    1      1  ...                0.0           0            0
1    98    1      1  ...                2.0           1            1
2    98    1      1  ...                2.0           0            0
3    98    1      1  ...                1.0           0            0
4    98    1      1  ...                0.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   98    1      4  ...                1.0           1            0
96   98    1      4  ...                2.0           1            0
97   98    1      4  ...                1.0           0            0
98   98    1      4  ...                2.0           1            0
99   98    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   120    1      1  ...                0.0           0            0
1   120    1      1  ...                2.0           0            1
2   120    1      1  ...                2.0           1            1
3   120    1      1  ...                2.0           1            1
4   120    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95  120    1      4  ...                1.0           1            1
96  120    1      4  ...                1.0           1            0
97  120    1      4  ...                2.0           0            0
98  120    1      4  ...                1.0           1            1
99  120    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    45    1      1  ...                0.0           0            0
1    45    1      1  ...                2.0           0            0
2    45    1      1  ...                1.0           1            1
3    45    1      1  ...                1.0           1            0
4    45    1      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   45    1      4  ...                2.0           1            0
96   45    1      4  ...                1.0           1            1
97   45    1      4  ...                1.0           0            1
98   45    1      4  ...                1.0           0            0
99   45    1      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    56    1      1  ...                0.0           0            0
1    56    1      1  ...                1.0           0            1
2    56    1      1  ...                1.0           0            0
3    56    1      1  ...                2.0           1            1
4    56    1      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   56    1      4  ...                2.0           0            1
96   56    1      4  ...                2.0           0            1
97   56    1      4  ...                2.0           0            1
98   56    1      4  ...                2.0           1            1
99   56    1      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    48    1      1  ...                0.0           0            0
1    48    1      1  ...                2.0           1            0
2    48    1      1  ...                1.0           1            1
3    48    1      1  ...                1.0           0            1
4    48    1      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   48    1      4  ...                1.0           0            1
96   48    1      4  ...                1.0           0            0
97   48    1      4  ...                2.0           1            1
98   48    1      4  ...                2.0           1            1
99   48    1      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    73    1      1  ...                0.0           0            0
1    73    1      1  ...                2.0           0            1
2    73    1      1  ...                2.0           0            0
3    73    1      1  ...                1.0           1            0
4    73    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   73    1      4  ...                2.0           1            1
96   73    1      4  ...                2.0           1            0
97   73    1      4  ...                1.0           1            1
98   73    1      4  ...                1.0           0            0
99   73    1      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    74    1      1  ...                0.0           0            1
1    74    1      1  ...                0.0           1            0
2    74    1      1  ...                1.0           0            0
3    74    1      1  ...                2.0           1            0
4    74    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   74    1      4  ...                1.0           0            0
96   74    1      4  ...                2.0           1            1
97   74    1      4  ...                2.0           0            0
98   74    1      4  ...                1.0           1            0
99   74    1      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    54    1      1  ...                0.0           0            0
1    54    1      1  ...                2.0           1            0
2    54    1      1  ...                1.0           0            0
3    54    1      1  ...                2.0           1            1
4    54    1      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   54    1      4  ...                2.0           1            1
96   54    1      4  ...                2.0           0            0
97   54    1      4  ...                1.0           1            0
98   54    1      4  ...                0.0           0            0
99   54    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    90    1      1  ...                0.0           0            0
1    90    1      1  ...                2.0           0            1
2    90    1      1  ...                2.0           1            0
3    90    1      1  ...                1.0           0            1
4    90    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   90    1      4  ...                0.0           0            0
96   90    1      4  ...                2.0           0            0
97   90    1      4  ...                1.0           0            0
98   90    1      4  ...                2.0           1            0
99   90    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    75    1      1  ...                0.0           0            0
1    75    1      1  ...                2.0           0            0
2    75    1      1  ...                1.0           1            1
3    75    1      1  ...                1.0           0            0
4    75    1      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   75    1      4  ...                2.0           1            1
96   75    1      4  ...                2.0           1            1
97   75    1      4  ...                2.0           0            1
98   75    1      4  ...                2.0           0            0
99   75    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   112    1      1  ...                0.0           0            0
1   112    1      1  ...                1.0           0            1
2   112    1      1  ...                1.0           1            0
3   112    1      1  ...                2.0           0            0
4   112    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95  112    1      4  ...                2.0           1            0
96  112    1      4  ...                1.0           1            0
97  112    1      4  ...                2.0           0            0
98  112    1      4  ...                1.0           1            1
99  112    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    41    1      1  ...                0.0           0            0
1    41    1      1  ...                2.0           0            1
2    41    1      1  ...                2.0           1            1
3    41    1      1  ...                2.0           0            0
4    41    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   41    1      4  ...                1.0           1            1
96   41    1      4  ...                1.0           0            0
97   41    1      4  ...                2.0           0            0
98   41    1      4  ...                1.0           1            1
99   41    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   113    1      1  ...                0.0           0            0
1   113    1      1  ...                2.0           1            0
2   113    1      1  ...                1.0           0            1
3   113    1      1  ...                1.0           0            1
4   113    1      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95  113    1      4  ...                2.0           1            1
96  113    1      4  ...                2.0           0            0
97  113    1      4  ...                1.0           0            1
98  113    1      4  ...                1.0           1            0
99  113    1      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    95    1      1  ...                0.0           0            0
1    95    1      1  ...                2.0           0            0
2    95    1      1  ...                1.0           1            0
3    95    1      1  ...                2.0           0            0
4    95    1      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   95    1      4  ...                1.0           0            0
96   95    1      4  ...                0.0           1            0
97   95    1      4  ...                2.0           1            1
98   95    1      4  ...                2.0           0            1
99   95    1      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    84    1      1  ...                0.0           0            0
1    84    1      1  ...                2.0           1            1
2    84    1      1  ...                2.0           0            0
3    84    1      1  ...                1.0           1            1
4    84    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   84    1      4  ...                1.0           0            1
96   84    1      4  ...                1.0           0            1
97   84    1      4  ...                1.0           0            0
98   84    1      4  ...                2.0           1            1
99   84    1      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   106    1      1  ...                0.0           0            0
1   106    1      1  ...                1.0           0            1
2   106    1      1  ...                1.0           1            1
3   106    1      1  ...                1.0           0            0
4   106    1      1  ...                0.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95  106    1      4  ...                0.0           0            0
96  106    1      4  ...                1.0           0            0
97  106    1      4  ...                0.0           0            0
98  106    1      4  ...                2.0           1            0
99  106    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    57    1      1  ...                0.0           0            0
1    57    1      1  ...                1.0           0            0
2    57    1      1  ...                2.0           0            1
3    57    1      1  ...                2.0           0            0
4    57    1      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   57    1      4  ...                0.0           1            0
96   57    1      4  ...                2.0           0            0
97   57    1      4  ...                1.0           0            0
98   57    1      4  ...                2.0           0            0
99   57    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    72    1      1  ...                0.0           0            0
1    72    1      1  ...                2.0           1            1
2    72    1      1  ...                2.0           0            1
3    72    1      1  ...                2.0           1            0
4    72    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   72    1      4  ...                1.0           0            0
96   72    1      4  ...                2.0           0            0
97   72    1      4  ...                1.0           1            1
98   72    1      4  ...                1.0           1            1
99   72    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   111    1      1  ...                0.0           0            0
1   111    1      1  ...                2.0           0            1
2   111    1      1  ...                2.0           1            0
3   111    1      1  ...                1.0           1            1
4   111    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95  111    1      4  ...                1.0           0            1
96  111    1      4  ...                1.0           0            0
97  111    1      4  ...                2.0           1            0
98  111    1      4  ...                1.0           0            1
99  111    1      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   119    1      1  ...                0.0           0            0
1   119    1      1  ...                1.0           1            0
2   119    1      1  ...                2.0           1            0
3   119    1      1  ...                1.0           0            0
4   119    1      1  ...                0.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95  119    1      4  ...                2.0           1            1
96  119    1      4  ...                2.0           0            1
97  119    1      4  ...                2.0           0            1
98  119    1      4  ...                2.0           0            1
99  119    1      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   117    1      1  ...                0.0           0            0
1   117    1      1  ...                2.0           1            0
2   117    1      1  ...                1.0           1            1
3   117    1      1  ...                1.0           1            1
4   117    1      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95  117    1      4  ...                2.0           1            1
96  117    1      4  ...                2.0           1            0
97  117    1      4  ...                1.0           1            0
98  117    1      4  ...                2.0           1            0
99  117    1      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    55    1      1  ...                0.0           0            0
1    55    1      1  ...                2.0           1            0
2    55    1      1  ...                1.0           0            1
3    55    1      1  ...                1.0           0            1
4    55    1      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   55    1      4  ...                1.0           1            0
96   55    1      4  ...                2.0           1            1
97   55    1      4  ...                2.0           0            0
98   55    1      4  ...                1.0           1            0
99   55    1      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    47    1      1  ...                0.0           0            0
1    47    1      1  ...                2.0           1            1
2    47    1      1  ...                2.0           0            1
3    47    1      1  ...                2.0           1            0
4    47    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   47    1      4  ...                1.0           1            0
96   47    1      4  ...                2.0           1            1
97   47    1      4  ...                2.0           0            1
98   47    1      4  ...                2.0           0            0
99   47    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    21    1      1  ...                0.0           0            0
1    21    1      1  ...                2.0           1            0
2    21    1      1  ...                1.0           1            1
3    21    1      1  ...                1.0           1            0
4    21    1      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   21    1      4  ...                1.0           1            0
96   21    1      4  ...                2.0           0            0
97   21    1      4  ...                1.0           0            1
98   21    1      4  ...                1.0           1            1
99   21    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   121    1      1  ...                0.0           0            0
1   121    1      1  ...                2.0           0            1
2   121    1      1  ...                2.0           1            0
3   121    1      1  ...                1.0           0            1
4   121    1      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95  121    1      4  ...                1.0           1            0
96  121    1      4  ...                2.0           0            1
97  121    1      4  ...                2.0           1            0
98  121    1      4  ...                1.0           0            1
99  121    1      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    71    1      1  ...                0.0           0            0
1    71    1      1  ...                1.0           1            0
2    71    1      1  ...                2.0           1            0
3    71    1      1  ...                1.0           1            1
4    71    1      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   71    1      4  ...                2.0           1            0
96   71    1      4  ...                0.0           0            0
97   71    1      4  ...                2.0           0            0
98   71    1      4  ...                1.0           1            1
99   71    1      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    93    1      1  ...                0.0           0            0
1    93    1      1  ...                2.0           1            1
2    93    1      1  ...                2.0           0            0
3    93    1      1  ...                1.0           0            1
4    93    1      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   93    1      4  ...                1.0           0            1
96   93    1      4  ...                1.0           1            0
97   93    1      4  ...                2.0           0            0
98   93    1      4  ...                1.0           0            1
99   93    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   104    1      1  ...                0.0           0            0
1   104    1      1  ...                2.0           1            0
2   104    1      1  ...                0.0           0            0
3   104    1      1  ...                1.0           1            0
4   104    1      1  ...                0.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95  104    1      4  ...                2.0           1            1
96  104    1      4  ...                2.0           0            0
97  104    1      4  ...                1.0           0            1
98  104    1      4  ...                1.0           1            0
99  104    1      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   116    1      1  ...                0.0           0            0
1   116    1      1  ...                2.0           0            1
2   116    1      1  ...                2.0           1            1
3   116    1      1  ...                2.0           0            1
4   116    1      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95  116    1      4  ...                2.0           0            0
96  116    1      4  ...                1.0           1            0
97  116    1      4  ...                2.0           1            0
98  116    1      4  ...                1.0           0            0
99  116    1      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    52    1      1  ...                0.0           0            1
1    52    1      1  ...                0.0           0            0
2    52    1      1  ...                2.0           1            1
3    52    1      1  ...                2.0           0            1
4    52    1      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   52    1      4  ...                1.0           1            0
96   52    1      4  ...                2.0           0            1
97   52    1      4  ...                2.0           0            1
98   52    1      4  ...                2.0           1            0
99   52    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    78    1      1  ...                0.0           0            0
1    78    1      1  ...                1.0           1            1
2    78    1      1  ...                1.0           1            0
3    78    1      1  ...                2.0           0            0
4    78    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   78    1      4  ...                2.0           1            1
96   78    1      4  ...                2.0           0            0
97   78    1      4  ...                1.0           1            0
98   78    1      4  ...                2.0           1            0
99   78    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    83    1      1  ...                0.0           0            0
1    83    1      1  ...                2.0           0            0
2    83    1      1  ...                0.0           1            0
3    83    1      1  ...                2.0           1            0
4    83    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   83    1      4  ...                2.0           1            1
96   83    1      4  ...                2.0           0            0
97   83    1      4  ...                1.0           0            0
98   83    1      4  ...                2.0           1            1
99   83    1      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    69    1      1  ...                0.0           0            0
1    69    1      1  ...                1.0           1            0
2    69    1      1  ...                2.0           1            0
3    69    1      1  ...                1.0           0            1
4    69    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   69    1      4  ...                1.0           0            1
96   69    1      4  ...                1.0           0            0
97   69    1      4  ...                2.0           0            1
98   69    1      4  ...                2.0           0            1
99   69    1      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    70    1      1  ...                0.0           0            0
1    70    1      1  ...                1.0           0            1
2    70    1      1  ...                1.0           0            0
3    70    1      1  ...                2.0           1            1
4    70    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   70    1      4  ...                1.0           1            0
96   70    1      4  ...                2.0           1            0
97   70    1      4  ...                1.0           0            1
98   70    1      4  ...                1.0           1            1
99   70    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   107    1      1  ...                0.0           0            0
1   107    1      1  ...                2.0           0            0
2   107    1      1  ...                1.0           0            0
3   107    1      1  ...                0.0           0            0
4   107    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95  107    1      4  ...                1.0           0            1
96  107    1      4  ...                1.0           1            1
97  107    1      4  ...                1.0           1            0
98  107    1      4  ...                2.0           0            1
99  107    1      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    51    1      1  ...                0.0           0            0
1    51    1      1  ...                1.0           1            0
2    51    1      1  ...                2.0           1            0
3    51    1      1  ...                1.0           1            0
4    51    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   51    1      4  ...                1.0           0            1
96   51    1      4  ...                1.0           1            0
97   51    1      4  ...                2.0           1            1
98   51    1      4  ...                2.0           1            0
99   51    1      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    68    1      1  ...                0.0           0            0
1    68    1      1  ...                2.0           1            0
2    68    1      1  ...                1.0           1            0
3    68    1      1  ...                2.0           1            1
4    68    1      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   68    1      4  ...                1.0           1            1
96   68    1      4  ...                1.0           0            1
97   68    1      4  ...                1.0           0            0
98   68    1      4  ...                2.0           0            1
99   68    1      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   118    1      1  ...                0.0           0            0
1   118    1      1  ...                1.0           1            1
2   118    1      1  ...                1.0           1            0
3   118    1      1  ...                2.0           1            1
4   118    1      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95  118    1      4  ...                2.0           1            0
96  118    1      4  ...                1.0           0            1
97  118    1      4  ...                1.0           0            0
98  118    1      4  ...                2.0           1            0
99  118    1      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    96    1      1  ...                0.0           0            0
1    96    1      1  ...                1.0           0            0
2    96    1      1  ...                0.0           0            0
3    96    1      1  ...                1.0           1            1
4    96    1      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   96    1      4  ...                1.0           0            1
96   96    1      4  ...                1.0           0            1
97   96    1      4  ...                1.0           1            1
98   96    1      4  ...                1.0           1            1
99   96    1      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0   101    1      1  ...                0.0           0            0
1   101    1      1  ...                1.0           1            1
2   101    1      1  ...                1.0           0            1
3   101    1      1  ...                1.0           0            0
4   101    1      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95  101    1      4  ...                2.0           1            1
96  101    1      4  ...                2.0           1            0
97  101    1      4  ...                1.0           0            0
98  101    1      4  ...                2.0           0            1
99  101    1      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    49    1      1  ...                0.0           0            0
1    49    1      1  ...                2.0           0            1
2    49    1      1  ...                2.0           1            0
3    49    1      1  ...                1.0           1            1
4    49    1      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   49    1      4  ...                2.0           1            0
96   49    1      4  ...                1.0           0            1
97   49    1      4  ...                1.0           1            1
98   49    1      4  ...                1.0           0            0
99   49    1      4  ...                2.0           1            0

[100 rows x 26 columns]]), ('Space_summary_dat', [   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  105   1  ...                  0.431373                 0.428571
1  105   1  ...                      0.25                 0.363636
2  105   1  ...                  0.615385                      0.3
3  105   1  ...                  0.461538                 0.222222
4  105   1  ...                       0.5                      0.6

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  89   1  ...                  0.418605                 0.509091
1  89   1  ...                       0.6                 0.333333
2  89   1  ...                  0.272727                 0.642857
3  89   1  ...                  0.428571                      0.5
4  89   1  ...                  0.461538                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  39   1  ...                     0.575                 0.454545
1  39   1  ...                       0.7                 0.153846
2  39   1  ...                  0.444444                 0.571429
3  39   1  ...                       0.6                 0.466667
4  39   1  ...                       0.5                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  80   1  ...                  0.711864                 0.658537
1  80   1  ...                  0.529412                      0.5
2  80   1  ...                  0.833333                 0.230769
3  80   1  ...                      0.75                 0.923077
4  80   1  ...                    0.8125                 0.777778

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  103   1  ...                   0.47619                     0.46
1  103   1  ...                       0.8                 0.583333
2  103   1  ...                       0.5                 0.470588
3  103   1  ...                  0.166667                      0.3
4  103   1  ...                  0.454545                 0.333333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  77   1  ...                       0.5                 0.509434
1  77   1  ...                  0.444444                 0.615385
2  77   1  ...                  0.444444                 0.357143
3  77   1  ...                      0.25                      0.5
4  77   1  ...                  0.666667                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  98   1  ...                  0.358974                      0.4
1  98   1  ...                  0.285714                   0.3125
2  98   1  ...                       0.0                 0.333333
3  98   1  ...                  0.555556                 0.384615
4  98   1  ...                  0.285714                 0.545455

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  120   1  ...                       0.5                    0.275
1  120   1  ...                       0.5                      0.2
2  120   1  ...                       0.5                 0.090909
3  120   1  ...                       0.6                      0.5
4  120   1  ...                       0.5                 0.222222

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  45   1  ...                  0.581818                 0.477273
1  45   1  ...                       0.6                      0.4
2  45   1  ...                       0.5                 0.461538
3  45   1  ...                  0.615385                 0.363636
4  45   1  ...                  0.615385                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  56   1  ...                   0.55102                     0.58
1  56   1  ...                  0.615385                      0.5
2  56   1  ...                  0.444444                   0.3125
3  56   1  ...                  0.666667                      0.5
4  56   1  ...                  0.461538                 0.916667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  48   1  ...                  0.630435                      0.7
1  48   1  ...                  0.666667                 0.636364
2  48   1  ...                  0.636364                 0.928571
3  48   1  ...                  0.538462                 0.416667
4  48   1  ...                  0.777778                 0.571429

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  73   1  ...                       0.5                 0.521739
1  73   1  ...                  0.461538                      0.5
2  73   1  ...                  0.285714                 0.272727
3  73   1  ...                  0.714286                 0.647059
4  73   1  ...                  0.583333                      0.4

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  74   1  ...                  0.528302                 0.394737
1  74   1  ...                  0.466667                     0.25
2  74   1  ...                  0.363636                 0.333333
3  74   1  ...                      0.75                      0.5
4  74   1  ...                  0.615385                      0.4

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  54   1  ...                  0.520833                 0.319149
1  54   1  ...                  0.266667                 0.111111
2  54   1  ...                       0.6                 0.333333
3  54   1  ...                  0.818182                 0.357143
4  54   1  ...                       0.5                 0.357143

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  90   1  ...                   0.52381                 0.545455
1  90   1  ...                  0.545455                 0.615385
2  90   1  ...                  0.461538                      0.5
3  90   1  ...                  0.714286                 0.529412
4  90   1  ...                       0.4                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  75   1  ...                  0.590909                      0.4
1  75   1  ...                      0.75                 0.166667
2  75   1  ...                  0.454545                 0.384615
3  75   1  ...                       0.5                   0.4375
4  75   1  ...                  0.615385                 0.545455

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  112   1  ...                  0.612245                 0.478261
1  112   1  ...                  0.666667                 0.416667
2  112   1  ...                  0.583333                 0.416667
3  112   1  ...                       0.6                 0.461538
4  112   1  ...                  0.642857                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  41   1  ...                  0.566667                      0.4
1  41   1  ...                  0.647059                     0.25
2  41   1  ...                  0.416667                 0.307692
3  41   1  ...                  0.733333                      0.4
4  41   1  ...                  0.461538                      0.5

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  113   1  ...                  0.673913                  0.72549
1  113   1  ...                  0.666667                 0.642857
2  113   1  ...                       0.7                 0.533333
3  113   1  ...                       0.6                      0.8
4  113   1  ...                  0.727273                 0.846154

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  95   1  ...                   0.45098                 0.391304
1  95   1  ...                  0.538462                 0.272727
2  95   1  ...                  0.416667                 0.307692
3  95   1  ...                  0.428571                      0.3
4  95   1  ...                  0.363636                 0.538462

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  84   1  ...                  0.391304                     0.52
1  84   1  ...                      0.25                 0.466667
2  84   1  ...                  0.538462                 0.583333
3  84   1  ...                  0.545455                 0.461538
4  84   1  ...                      0.25                      0.5

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  106   1  ...                  0.522727                 0.631579
1  106   1  ...                  0.666667                      0.7
2  106   1  ...                       0.5                 0.666667
3  106   1  ...                       0.5                 0.571429
4  106   1  ...                     0.375                 0.538462

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  57   1  ...                   0.44186                 0.408163
1  57   1  ...                  0.545455                     0.25
2  57   1  ...                       0.4                 0.333333
3  57   1  ...                       0.3                 0.571429
4  57   1  ...                  0.454545                     0.25

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  72   1  ...                  0.446809                 0.519231
1  72   1  ...                  0.545455                 0.571429
2  72   1  ...                       0.4                      0.5
3  72   1  ...                  0.363636                      0.5
4  72   1  ...                  0.555556                 0.466667

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  111   1  ...                  0.333333                 0.422222
1  111   1  ...                  0.333333                      0.3
2  111   1  ...                       0.4                 0.416667
3  111   1  ...                  0.555556                 0.363636
4  111   1  ...                       0.0                 0.538462

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  119   1  ...                  0.714286                    0.625
1  119   1  ...                       0.6                 0.454545
2  119   1  ...                  0.785714                 0.555556
3  119   1  ...                       0.8                 0.714286
4  119   1  ...                     0.625                 0.642857

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  117   1  ...                   0.47619                 0.472727
1  117   1  ...                  0.363636                 0.642857
2  117   1  ...                  0.666667                 0.473684
3  117   1  ...                  0.461538                 0.454545
4  117   1  ...                  0.454545                     0.25

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  55   1  ...                       0.6                 0.693878
1  55   1  ...                  0.533333                      0.9
2  55   1  ...                  0.666667                   0.5625
3  55   1  ...                       0.7                 0.666667
4  55   1  ...                  0.615385                 0.545455

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  47   1  ...                  0.709091                 0.595238
1  47   1  ...                  0.714286                 0.666667
2  47   1  ...                  0.416667                 0.461538
3  47   1  ...                  0.777778                 0.571429
4  47   1  ...                  0.909091                 0.615385

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  21   1  ...                      0.34                 0.477273
1  21   1  ...                  0.357143                 0.444444
2  21   1  ...                  0.272727                 0.416667
3  21   1  ...                  0.166667                 0.666667
4  21   1  ...                  0.538462                 0.363636

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  121   1  ...                  0.568182                 0.564103
1  121   1  ...                       0.6                 0.454545
2  121   1  ...                       0.6                 0.333333
3  121   1  ...                       0.6                      0.7
4  121   1  ...                  0.538462                      0.7

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  71   1  ...                  0.489796                      0.4
1  71   1  ...                  0.588235                 0.571429
2  71   1  ...                       0.5                 0.357143
3  71   1  ...                  0.363636                 0.444444
4  71   1  ...                       0.6                 0.230769

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  93   1  ...                  0.480769                 0.295455
1  93   1  ...                  0.692308                      0.1
2  93   1  ...                  0.307692                      0.5
3  93   1  ...                       0.5                      0.4
4  93   1  ...                       0.4                 0.142857

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  104   1  ...                  0.435897                 0.395833
1  104   1  ...                       0.0                 0.428571
2  104   1  ...                  0.307692                      0.3
3  104   1  ...                  0.636364                 0.416667
4  104   1  ...                  0.555556                 0.357143

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  116   1  ...                      0.46                 0.431818
1  116   1  ...                  0.533333                      0.7
2  116   1  ...                  0.333333                 0.416667
3  116   1  ...                  0.416667                 0.454545
4  116   1  ...                  0.416667                 0.153846

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  52   1  ...                  0.355556                     0.55
1  52   1  ...                  0.555556                 0.666667
2  52   1  ...                  0.181818                 0.454545
3  52   1  ...                  0.363636                 0.272727
4  52   1  ...                  0.416667                 0.636364

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  78   1  ...                  0.423077                 0.487805
1  78   1  ...                       0.5                    0.625
2  78   1  ...                  0.454545                 0.333333
3  78   1  ...                  0.214286                      0.2
4  78   1  ...                  0.538462                 0.727273

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  83   1  ...                  0.479167                      0.5
1  83   1  ...                  0.384615                 0.545455
2  83   1  ...                       0.4                 0.615385
3  83   1  ...                  0.461538                      0.3
4  83   1  ...                       0.7                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  69   1  ...                  0.340909                 0.541667
1  69   1  ...                       0.5                 0.666667
2  69   1  ...                  0.272727                      0.3
3  69   1  ...                       0.4                 0.461538
4  69   1  ...                       0.2                 0.642857

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  70   1  ...                      0.46                  0.55814
1  70   1  ...                  0.363636                 0.307692
2  70   1  ...                  0.333333                 0.545455
3  70   1  ...                  0.692308                 0.727273
4  70   1  ...                  0.454545                 0.545455

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  107   1  ...                  0.511111                 0.468085
1  107   1  ...                  0.285714                 0.307692
2  107   1  ...                  0.454545                 0.461538
3  107   1  ...                  0.642857                 0.454545
4  107   1  ...                  0.545455                 0.583333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  51   1  ...                  0.403509                 0.378378
1  51   1  ...                  0.470588                 0.166667
2  51   1  ...                  0.357143                 0.444444
3  51   1  ...                  0.454545                 0.307692
4  51   1  ...                  0.357143                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  68   1  ...                  0.357143                 0.365854
1  68   1  ...                  0.466667                      0.3
2  68   1  ...                  0.294118                 0.428571
3  68   1  ...                       0.4                 0.307692
4  68   1  ...                  0.333333                 0.384615

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  118   1  ...                   0.55814                 0.571429
1  118   1  ...                  0.538462                      0.6
2  118   1  ...                       0.5                      0.6
3  118   1  ...                     0.625                 0.384615
4  118   1  ...                  0.615385                 0.666667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  96   1  ...                  0.418605                  0.44898
1  96   1  ...                  0.636364                 0.333333
2  96   1  ...                  0.333333                 0.444444
3  96   1  ...                       0.2                 0.235294
4  96   1  ...                  0.363636                 0.666667

[5 rows x 16 columns],    sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  101   1  ...                  0.431034                      0.5
1  101   1  ...                  0.214286                 0.454545
2  101   1  ...                  0.333333                 0.363636
3  101   1  ...                    0.5625                 0.555556
4  101   1  ...                  0.571429                 0.545455

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  49   1  ...                  0.460317                      0.6
1  49   1  ...                  0.333333                 0.555556
2  49   1  ...                    0.5625                 0.444444
3  49   1  ...                     0.375                 0.555556
4  49   1  ...                  0.533333                 0.666667

[5 rows x 16 columns]]), ('bids_dir', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat'), ('function_str', "def updateDatabase_save(Space_summary_dat, Space_group_trialdat, overwrite_flag, bids_dir):\n    import pandas as pd\n    import numpy as np\n    from pathlib import Path\n    from nipype.interfaces.base import Bunch\n\n    #derivative data path\n    derivative_data_path = Path(bids_dir).joinpath('derivatives/preprocessed/beh')\n\n    #function to drop rows based on values\n    def filter_rows_by_values(df, sub_values, sesnum):\n        #filter based on sub and ses\n        return df[(df['sub'].isin(sub_values) == False) & (df['ses'] == sesnum)]\n\n    #### Summary Data ####\n    #get a Bunch object if more than 1 participant \n    if isinstance(Space_summary_dat, Bunch):        \n        #get output data from node\n        Space_summary_datlist = Space_summary_dat.summarySpace_dat\n\n        #combine datasets \n        Space_summary_dat = pd.concat(Space_summary_datlist)\n\n    #if only 1 participant/dataset then it is a list    \n    elif isinstance(Space_summary_dat, list):\n        if len(Space_summary_dat) == 1:\n            Space_summary_dat = Space_summary_dat[0]\n        else:\n            Space_summary_dat = pd.concat(Space_summary_dat)\n\n    #if a pandas dataframe\n    if isinstance(Space_summary_dat, pd.DataFrame):\n\n        #get column names\n        columnnames = Space_summary_dat.columns\n\n        #get session subsets\n        db_sessions = Space_summary_dat.ses.unique()\n\n        if len(db_sessions) > 1:\n            Space_sum_ses1_dat = Space_summary_dat.groupby('ses').get_group(1)\n            Space_sum_ses2_dat = Space_summary_dat.groupby('ses').get_group(2)\n\n            #make wide data set \n            Space_sum_ses1_wide = Space_sum_ses1_dat.pivot(columns='block', index='sub', values=columnnames[3:16])\n            Space_sum_ses1_wide.columns = ['_'.join(col) for col in Space_sum_ses1_wide.columns.reorder_levels(order=[1, 0])]\n\n            Space_sum_ses2_wide = Space_sum_ses2_dat.pivot(columns='block', index='sub', values=columnnames[3:16])\n            Space_sum_ses2_wide.columns = ['_'.join(col) for col in Space_sum_ses2_wide.columns.reorder_levels(order=[1, 0])]\n\n            #make the sub index into a dataset column\n            Space_sum_ses1_wide = Space_sum_ses1_wide.reset_index(level = 0)\n            Space_sum_ses2_wide = Space_sum_ses2_wide.reset_index(level = 0)\n\n            #add session\n            Space_sum_ses1_wide.insert(1, 'ses', 1)\n            Space_sum_ses2_wide.insert(1, 'ses', 2)\n\n            #concatonate databases\n            Space_summary_wide = pd.concat([Space_sum_ses1_wide,Space_sum_ses2_wide],ignore_index=True)\n\n        else:\n            #make wide data set \n            Space_summary_wide = Space_summary_dat.pivot(columns='block', index='sub', values=columnnames[3:16])        \n            Space_summary_wide.columns = ['_'.join(col) for col in Space_summary_wide.columns.reorder_levels(order=[1, 0])]\n\n            #make the sub index into a dataset column\n            Space_summary_wide = Space_summary_wide.reset_index(level = 0)\n\n            #add session\n            Space_summary_wide.insert(1, 'ses', db_sessions[0])\n\n        #re-order columns\n        columnnames_reorder = ['sub', 'ses', 'all_earth_rt_mean', 'all_earth_rt_median', 'all_earth_n_miss',\n                    'all_earth_p_miss', 'all_planet_rt_mean', 'all_planet_rt_median', 'all_planet_n_miss',\n                    'all_planet_p_miss', 'all_reward_rate', 'all_avg_reward', 'all_reward_rate_corrected', \n                    'all_prob_sameplanet_earthsame', 'all_prob_sameplanet_earthdif',\n                    'b1_earth_rt_mean', 'b1_earth_rt_median', 'b1_earth_n_miss', 'b1_earth_p_miss',\n                    'b1_planet_rt_mean', 'b1_planet_rt_median', 'b1_planet_n_miss', 'b1_planet_p_miss',\n                    'b1_reward_rate', 'b1_avg_reward', 'b1_reward_rate_corrected',\n                    'b1_prob_sameplanet_earthsame','b1_prob_sameplanet_earthdif',\n                    'b2_earth_rt_mean', 'b2_earth_rt_median', 'b2_earth_n_miss', 'b2_earth_p_miss',\n                    'b2_planet_rt_mean', 'b2_planet_rt_median', 'b2_planet_n_miss', 'b2_planet_p_miss',\n                    'b2_reward_rate', 'b2_avg_reward', 'b2_reward_rate_corrected',\n                    'b2_prob_sameplanet_earthsame', 'b2_prob_sameplanet_earthdif',\n                    'b3_earth_rt_mean', 'b3_earth_rt_median', 'b3_earth_n_miss', 'b3_earth_p_miss',\n                    'b3_planet_rt_mean','b3_planet_rt_median', 'b3_planet_n_miss', 'b3_planet_p_miss',\n                    'b3_reward_rate', 'b3_avg_reward', 'b3_reward_rate_corrected', \n                    'b3_prob_sameplanet_earthsame','b3_prob_sameplanet_earthdif',\n                    'b4_earth_rt_mean', 'b4_earth_rt_median', 'b4_earth_n_miss', 'b4_earth_p_miss', \n                    'b4_planet_rt_mean', 'b4_planet_rt_median', 'b4_planet_n_miss', 'b4_planet_p_miss',  \n                    'b4_reward_rate', 'b4_avg_reward', 'b4_reward_rate_corrected', \n                    'b4_prob_sameplanet_earthsame', 'b4_prob_sameplanet_earthdif']\n\n        Space_summary_wide = Space_summary_wide.reindex(columns=columnnames_reorder)\n\n        #get blocks subset\n        Space_summary_blocks = Space_summary_dat[Space_summary_dat.block.isin(['b1', 'b2', 'b3', 'b4'])] \n\n        #load databases\n        Space_database_wide = pd.read_csv(str(Path(derivative_data_path).joinpath('task-space_summary.tsv')), sep = '\\t') \n        Space_database_blocks = pd.read_csv(str(Path(derivative_data_path).joinpath('task-space_summary_long.tsv')), sep = '\\t')\n\n        #if overwriting participants\n        if overwrite_flag == True:\n            #filter out/remove exisiting subs to overwrit~\n            if len(db_sessions) > 1:\n                #get list of subs by ses to filter in wide and long data\n                wide_sub_list = Space_summary_wide.groupby('ses')['sub'].unique()\n                long_sub_list = Space_summary_blocks.groupby('ses')['sub'].unique()\n\n                Space_database_ses1 = filter_rows_by_values(Space_database_wide, wide_sub_list[0], 1)\n                Space_database_ses2 = filter_rows_by_values(Space_database_wide, wide_sub_list[1], 2)\n\n                Space_database_ses1_long = filter_rows_by_values(Space_database_blocks, long_sub_list[0], 1)\n                Space_database_ses2_long = filter_rows_by_values(Space_database_blocks, long_sub_list[1], 2)\n\n                #concatonate databases\n                Space_database_wide = pd.concat([Space_database_ses1, Space_database_ses2],ignore_index=True)\n                Space_database_blocks = pd.concat([Space_database_ses1_long, Space_database_ses2_long],ignore_index=True)\n\n            else:\n                wide_sub_list = list(Space_summary_wide['sub'].unique())\n                long_sub_list = list(Space_summary_blocks['sub'].unique())\n\n                #filter by ses and sub\n                Space_database_ses = filter_rows_by_values(Space_database_wide, wide_sub_list, db_sessions[0])\n                Space_database_long_ses = filter_rows_by_values(Space_database_blocks, long_sub_list, db_sessions[0])\n\n                #concatonate with other session in full database\n                Space_database_wide = pd.concat([Space_database_wide[Space_database_wide['ses'] != db_sessions[0]], Space_database_ses],ignore_index=True)\n                Space_database_blocks = pd.concat([Space_database_blocks[Space_database_blocks['ses'] != db_sessions[0]], Space_database_long_ses],ignore_index=True)\n\n\n        #add newly processed data\n        Space_database_wide = Space_database_wide.append(Space_summary_wide)\n        Space_database_blocks = Space_database_blocks.append(Space_summary_blocks)\n\n        #sort to ensure in sub order\n        Space_database_wide = Space_database_wide.sort_values(by = ['ses', 'sub'])\n        Space_database_blocks = Space_database_blocks.sort_values(by = ['ses', 'sub', 'block'])\n\n        #round to 3 decimal points\n        Space_database_wide = Space_database_wide.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)\n        Space_database_blocks = Space_database_blocks.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)\n\n        #write databases\n        Space_database_wide.to_csv(str(Path(derivative_data_path).joinpath('task-space_summary.tsv')), sep = '\\t', encoding='utf-8-sig', index = False) \n        Space_database_blocks.to_csv(str(Path(derivative_data_path).joinpath('task-space_summary_long.tsv')), sep = '\\t', encoding='utf-8-sig', index = False)\n\n    else:\n        print('No raw data files that need to be processed')\n        Space_database_wide = np.nan\n        Space_database_blocks = np.nan\n\n    #### Group trial data ####\n\n    #get a Bunch object if more than 1 participant \n    if isinstance(Space_group_trialdat, Bunch):        \n        #get output data from node\n        Space_group_trialdatlist = Space_group_trialdat.group_trialdat\n\n        #combine datasets \n        Space_groupdat = pd.concat(Space_group_trialdatlist)\n\n    #if only 1 participant/dataset then it is a list    \n    elif isinstance(Space_group_trialdat, list):\n        if len(Space_group_trialdat) == 1:\n            Space_groupdat = Space_group_trialdat[0]\n        else:\n            Space_groupdat = pd.concat(Space_group_trialdat)\n\n    #if a pandas dataframe\n    if isinstance(Space_groupdat, pd.DataFrame):\n\n        #get session subsets\n        db_group_sessions = Space_groupdat.ses.unique()\n\n        #load databases\n        Space_groupdat_database = pd.read_csv(str(Path(derivative_data_path).joinpath('task-space_groupdata.tsv')), sep = '\\t') \n\n        #if overwriting participants\n        if overwrite_flag == True:\n            #filter out/remove exisiting subs to overwrit~\n            if len(db_group_sessions) > 1:\n                #get list of subs by ses to filter in wide and long data\n                dat_sub_list = Space_groupdat.groupby('ses')['sub'].unique()\n\n                Space_groupdat_ses1 = filter_rows_by_values(Space_groupdat_database, dat_sub_list[0], 1)\n                Space_groupdat_ses2 = filter_rows_by_values(Space_groupdat_database, dat_sub_list[1], 2)\n\n                #concatonate databases\n                Space_groupdat_database = pd.concat([Space_groupdat_ses1, Space_groupdat_ses2],ignore_index=True)\n\n            else:\n                dat_sub_list = list(Space_groupdat['sub'].unique())\n\n                #filter by ses and sub\n                Space_groupdat_ses = filter_rows_by_values(Space_groupdat_database, dat_sub_list, db_group_sessions[0])\n\n                #concatonate with other session in full database\n                Space_groupdat_database = pd.concat([Space_groupdat_database[Space_groupdat_database['ses'] != db_group_sessions[0]], Space_groupdat_ses],ignore_index=True)\n\n        #add newly processed data\n        Space_groupdat_database = Space_groupdat_database.append(Space_groupdat)\n\n        #sort to ensure in sub order\n        Space_groupdat_database = Space_groupdat_database.sort_values(by = ['sub', 'ses'])\n\n        #round to 3 decimal points\n        Space_groupdat_database = Space_groupdat_database.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)\n\n        #write databases\n        Space_groupdat_database.to_csv(str(Path(derivative_data_path).joinpath('task-space_groupdata.tsv')), sep = '\\t', encoding='utf-8-sig', index = False) \n\n    else:\n        print('No raw trial data files that need to be processed')\n        Space_groupdat = np.nan\n\n    return Space_database_wide, Space_database_blocks, Space_groupdat\n"), ('overwrite_flag', True)]