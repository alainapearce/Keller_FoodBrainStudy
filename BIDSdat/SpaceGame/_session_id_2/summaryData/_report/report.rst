Node: summaryData (utility)
===========================


 Hierarchy : SpaceGame.summaryData
 Exec ID : summaryData.a1


Original Inputs
---------------


* Space_file : ['/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-089/ses-2/beh/sub-089_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-001/ses-2/beh/sub-001_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-049/ses-2/beh/sub-049_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-039/ses-2/beh/sub-039_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-080/ses-2/beh/sub-080_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-006/ses-2/beh/sub-006_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-002/ses-2/beh/sub-002_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-023/ses-2/beh/sub-023_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-020/ses-2/beh/sub-020_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-045/ses-2/beh/sub-045_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-009/ses-2/beh/sub-009_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-074/ses-2/beh/sub-074_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-073/ses-2/beh/sub-073_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-094/ses-2/beh/sub-094_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-028/ses-2/beh/sub-028_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-054/ses-2/beh/sub-054_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-019/ses-2/beh/sub-019_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-041/ses-2/beh/sub-041_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-095/ses-2/beh/sub-095_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-005/ses-2/beh/sub-005_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-084/ses-2/beh/sub-084_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-043/ses-2/beh/sub-043_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-003/ses-2/beh/sub-003_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-055/ses-2/beh/sub-055_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-007/ses-2/beh/sub-007_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-038/ses-2/beh/sub-038_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-026/ses-2/beh/sub-026_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-021/ses-2/beh/sub-021_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-033/ses-2/beh/sub-033_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-071/ses-2/beh/sub-071_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-093/ses-2/beh/sub-093_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-018/ses-2/beh/sub-018_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-052/ses-2/beh/sub-052_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-035/ses-2/beh/sub-035_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-078/ses-2/beh/sub-078_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-011/ses-2/beh/sub-011_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-083/ses-2/beh/sub-083_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-037/ses-2/beh/sub-037_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-040/ses-2/beh/sub-040_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-051/ses-2/beh/sub-051_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-068/ses-2/beh/sub-068_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-096/ses-2/beh/sub-096_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-017/ses-2/beh/sub-017_ses-2_task-space_events.tsv']
* base_directory : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat
* function_str : def summarySpace(Space_file, base_directory):
    import numpy as np
    import pandas as pd
    import scipy.io as sio
    from pathlib import Path

    ###################################################################
    ####                   Sub-function script                     ####

    #need to sub-functions within the function that is called by the node just 
    #like you need to re-import libraries
    def summary_stats(Space_data):

        #Earth RT
        earthRT_mean = Space_data.loc[Space_data['rt_earth'] > 0, 'rt_earth'].mean(axis = 0)*1000  
        earthRT_median = Space_data.loc[Space_data['rt_earth'] > 0, 'rt_earth'].median(axis = 0)*1000  

        #Earth missed
        earth_n_miss = Space_data['missed_earth'].sum(axis = 0)
        earth_p_miss = Space_data['missed_earth'].sum(axis = 0)/Space_data['missed_earth'].shape[0]

        #Planet RT
        planetRT_mean = Space_data.loc[Space_data['rt_planet'] > 0, 'rt_planet'].mean(axis = 0)*1000  
        planetRT_median = Space_data.loc[Space_data['rt_planet'] > 0, 'rt_planet'].median(axis = 0)*1000  

        #Planet missed
        planet_n_miss = Space_data['missed_planet'].sum(axis = 0)
        planet_p_miss = Space_data['missed_planet'].sum(axis = 0)/Space_data['missed_planet'].shape[0]

        #reward rate
        reward_rate = Space_data.loc[(Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'points'].mean(axis = 0)

        #average reward overall across both options
        rewards = Space_data[['rewards1', 'rewards2']].values.tolist()
        rewards_flat = [item for sublist in rewards for item in sublist]
        avg_reward = sum(rewards_flat)/len(rewards_flat)

        #corrected reward rate
        reward_rate_corrected = reward_rate - avg_reward

        #stay probabilities (always won previously as no negatives) for if
        #earth state is same or different
        prob_sameplanet_earthsame = Space_data.loc[(Space_data['same_earth'] == 1) & (Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'same_planet'].mean(axis = 0)
        prob_sameplanet_earthdif = Space_data.loc[(Space_data['same_earth'] == 0) & (Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'same_planet'].mean(axis = 0)

        summary_results = [earthRT_mean, earthRT_median, earth_n_miss, earth_p_miss, planetRT_mean, planetRT_median, 
                            planet_n_miss, planet_p_miss, reward_rate, avg_reward, reward_rate_corrected, 
                            prob_sameplanet_earthsame, prob_sameplanet_earthdif]

        return(summary_results)

    ###################################################################
    ####                Primary function script                    ####

    #summary column names
    colnames = ['sub', 'ses', 'block', 'earth_rt_mean', 'earth_rt_median', 'earth_n_miss', 'earth_p_miss', 'planet_rt_mean', 
                'planet_rt_median', 'planet_n_miss', 'planet_p_miss', 'reward_rate', 'avg_reward', 
                'reward_rate_corrected', 'prob_sameplanet_earthsame', 'prob_sameplanet_earthdif']

    #check if str
    if isinstance(Space_file, str):

        #check to see if it is filepath str or 'No subfiles' message
        if '.tsv' in Space_file:
            #if only 1 file, will be string and we want an array
            Space_file = [Space_file]
        else:
            Space_file = []

    if len(Space_file) > 0:

        #loop counter
        count = 0

        #supress warning
        pd.options.mode.chained_assignment = None

        for file in Space_file:

            #load data 
            Space_ProcData = pd.read_csv(str(file), sep = '\t', encoding = 'utf-8-sig', engine='python') 

            #add previous trial data
            Space_ProcData['prev_state_earth'] = Space_ProcData['state_earth'].shift(1)
            Space_ProcData['prev_state_earth'] = np.where(np.isnan(Space_ProcData['prev_state_earth']), 0, Space_ProcData['prev_state_earth'])

            Space_ProcData['prev_state_planet'] = Space_ProcData['state_planet'].shift(1)
            Space_ProcData['prev_state_planet'] = np.where(np.isnan(Space_ProcData['prev_state_planet']), 0, Space_ProcData['prev_state_planet'])

            Space_ProcData['same_earth'] = np.where(Space_ProcData['state_earth'] == Space_ProcData['prev_state_earth'], 1, 0)
            Space_ProcData['same_planet'] = np.where(Space_ProcData['state_planet'] == Space_ProcData['prev_state_planet'], 1, 0)

            #summary stats - across all blocks
            all_trials_stat = summary_stats(Space_ProcData)
            all_trials_stat.insert(0, Space_ProcData.loc[0, 'sub'])
            all_trials_stat.insert(1, Space_ProcData.loc[0, 'ses'])
            all_trials_stat.insert(2, 'all')

            if count == 0:
                #make summary dataset
                overall_summary_data = pd.DataFrame(all_trials_stat).T
                overall_summary_data.columns = colnames

                #make group_trailsdat dataset
                space_group_trialsdat = Space_ProcData
            else:
                #add to summary dataset
                overall_summary_data.loc[len(overall_summary_data)] = all_trials_stat

                #add to group_trailsdat dataset
                space_group_trialsdat = Space_ProcData
                space_group_trialsdat = pd.concat([space_group_trialsdat, Space_ProcData],ignore_index=True)

            # summary stats - by block 
            for b in np.unique(Space_ProcData['block']):
                #get block data
                block_data = Space_ProcData.loc[Space_ProcData['block'] == b]

                #re-do previous trial data base on just current block
                block_data['prev_state_earth'] = block_data['state_earth'].shift(1)
                block_data['prev_state_earth'] = np.where(np.isnan(block_data['prev_state_earth']), 0, block_data['prev_state_earth'])

                block_data['prev_state_planet'] = block_data['state_planet'].shift(1)
                block_data['prev_state_planet'] = np.where(np.isnan(block_data['prev_state_planet']), 0, block_data['prev_state_planet'])

                block_data['same_earth'] = np.where(block_data['state_earth'] == block_data['prev_state_earth'], 1, 0)
                block_data['same_planet'] = np.where(block_data['state_planet'] == block_data['prev_state_planet'], 1, 0)

                #get summary results
                block_trials_stat = summary_stats(block_data)
                block_trials_stat.insert(0, Space_ProcData.loc[0, 'sub'])
                block_trials_stat.insert(1, Space_ProcData.loc[0, 'ses'])

                block_name = 'b' + str(b)
                block_trials_stat.insert(2, block_name)

                #append new rows
                overall_summary_data.loc[len(overall_summary_data)] = block_trials_stat

            #update count for files loop
            count = 1

    else:
         overall_summary_data = 'no files'

    return overall_summary_data, space_group_trialsdat



Execution Inputs
----------------


* Space_file : ['/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-089/ses-2/beh/sub-089_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-001/ses-2/beh/sub-001_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-049/ses-2/beh/sub-049_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-039/ses-2/beh/sub-039_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-080/ses-2/beh/sub-080_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-006/ses-2/beh/sub-006_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-002/ses-2/beh/sub-002_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-023/ses-2/beh/sub-023_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-020/ses-2/beh/sub-020_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-045/ses-2/beh/sub-045_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-009/ses-2/beh/sub-009_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-074/ses-2/beh/sub-074_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-073/ses-2/beh/sub-073_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-094/ses-2/beh/sub-094_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-028/ses-2/beh/sub-028_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-054/ses-2/beh/sub-054_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-019/ses-2/beh/sub-019_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-041/ses-2/beh/sub-041_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-095/ses-2/beh/sub-095_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-005/ses-2/beh/sub-005_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-084/ses-2/beh/sub-084_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-043/ses-2/beh/sub-043_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-003/ses-2/beh/sub-003_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-055/ses-2/beh/sub-055_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-007/ses-2/beh/sub-007_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-038/ses-2/beh/sub-038_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-026/ses-2/beh/sub-026_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-021/ses-2/beh/sub-021_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-033/ses-2/beh/sub-033_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-071/ses-2/beh/sub-071_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-093/ses-2/beh/sub-093_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-018/ses-2/beh/sub-018_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-052/ses-2/beh/sub-052_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-035/ses-2/beh/sub-035_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-078/ses-2/beh/sub-078_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-011/ses-2/beh/sub-011_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-083/ses-2/beh/sub-083_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-037/ses-2/beh/sub-037_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-040/ses-2/beh/sub-040_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-051/ses-2/beh/sub-051_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-068/ses-2/beh/sub-068_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-096/ses-2/beh/sub-096_ses-2_task-space_events.tsv', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/raw_data/sub-017/ses-2/beh/sub-017_ses-2_task-space_events.tsv']
* base_directory : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat
* function_str : def summarySpace(Space_file, base_directory):
    import numpy as np
    import pandas as pd
    import scipy.io as sio
    from pathlib import Path

    ###################################################################
    ####                   Sub-function script                     ####

    #need to sub-functions within the function that is called by the node just 
    #like you need to re-import libraries
    def summary_stats(Space_data):

        #Earth RT
        earthRT_mean = Space_data.loc[Space_data['rt_earth'] > 0, 'rt_earth'].mean(axis = 0)*1000  
        earthRT_median = Space_data.loc[Space_data['rt_earth'] > 0, 'rt_earth'].median(axis = 0)*1000  

        #Earth missed
        earth_n_miss = Space_data['missed_earth'].sum(axis = 0)
        earth_p_miss = Space_data['missed_earth'].sum(axis = 0)/Space_data['missed_earth'].shape[0]

        #Planet RT
        planetRT_mean = Space_data.loc[Space_data['rt_planet'] > 0, 'rt_planet'].mean(axis = 0)*1000  
        planetRT_median = Space_data.loc[Space_data['rt_planet'] > 0, 'rt_planet'].median(axis = 0)*1000  

        #Planet missed
        planet_n_miss = Space_data['missed_planet'].sum(axis = 0)
        planet_p_miss = Space_data['missed_planet'].sum(axis = 0)/Space_data['missed_planet'].shape[0]

        #reward rate
        reward_rate = Space_data.loc[(Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'points'].mean(axis = 0)

        #average reward overall across both options
        rewards = Space_data[['rewards1', 'rewards2']].values.tolist()
        rewards_flat = [item for sublist in rewards for item in sublist]
        avg_reward = sum(rewards_flat)/len(rewards_flat)

        #corrected reward rate
        reward_rate_corrected = reward_rate - avg_reward

        #stay probabilities (always won previously as no negatives) for if
        #earth state is same or different
        prob_sameplanet_earthsame = Space_data.loc[(Space_data['same_earth'] == 1) & (Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'same_planet'].mean(axis = 0)
        prob_sameplanet_earthdif = Space_data.loc[(Space_data['same_earth'] == 0) & (Space_data['missed_earth'] == 0) & (Space_data['missed_planet'] == 0), 'same_planet'].mean(axis = 0)

        summary_results = [earthRT_mean, earthRT_median, earth_n_miss, earth_p_miss, planetRT_mean, planetRT_median, 
                            planet_n_miss, planet_p_miss, reward_rate, avg_reward, reward_rate_corrected, 
                            prob_sameplanet_earthsame, prob_sameplanet_earthdif]

        return(summary_results)

    ###################################################################
    ####                Primary function script                    ####

    #summary column names
    colnames = ['sub', 'ses', 'block', 'earth_rt_mean', 'earth_rt_median', 'earth_n_miss', 'earth_p_miss', 'planet_rt_mean', 
                'planet_rt_median', 'planet_n_miss', 'planet_p_miss', 'reward_rate', 'avg_reward', 
                'reward_rate_corrected', 'prob_sameplanet_earthsame', 'prob_sameplanet_earthdif']

    #check if str
    if isinstance(Space_file, str):

        #check to see if it is filepath str or 'No subfiles' message
        if '.tsv' in Space_file:
            #if only 1 file, will be string and we want an array
            Space_file = [Space_file]
        else:
            Space_file = []

    if len(Space_file) > 0:

        #loop counter
        count = 0

        #supress warning
        pd.options.mode.chained_assignment = None

        for file in Space_file:

            #load data 
            Space_ProcData = pd.read_csv(str(file), sep = '\t', encoding = 'utf-8-sig', engine='python') 

            #add previous trial data
            Space_ProcData['prev_state_earth'] = Space_ProcData['state_earth'].shift(1)
            Space_ProcData['prev_state_earth'] = np.where(np.isnan(Space_ProcData['prev_state_earth']), 0, Space_ProcData['prev_state_earth'])

            Space_ProcData['prev_state_planet'] = Space_ProcData['state_planet'].shift(1)
            Space_ProcData['prev_state_planet'] = np.where(np.isnan(Space_ProcData['prev_state_planet']), 0, Space_ProcData['prev_state_planet'])

            Space_ProcData['same_earth'] = np.where(Space_ProcData['state_earth'] == Space_ProcData['prev_state_earth'], 1, 0)
            Space_ProcData['same_planet'] = np.where(Space_ProcData['state_planet'] == Space_ProcData['prev_state_planet'], 1, 0)

            #summary stats - across all blocks
            all_trials_stat = summary_stats(Space_ProcData)
            all_trials_stat.insert(0, Space_ProcData.loc[0, 'sub'])
            all_trials_stat.insert(1, Space_ProcData.loc[0, 'ses'])
            all_trials_stat.insert(2, 'all')

            if count == 0:
                #make summary dataset
                overall_summary_data = pd.DataFrame(all_trials_stat).T
                overall_summary_data.columns = colnames

                #make group_trailsdat dataset
                space_group_trialsdat = Space_ProcData
            else:
                #add to summary dataset
                overall_summary_data.loc[len(overall_summary_data)] = all_trials_stat

                #add to group_trailsdat dataset
                space_group_trialsdat = Space_ProcData
                space_group_trialsdat = pd.concat([space_group_trialsdat, Space_ProcData],ignore_index=True)

            # summary stats - by block 
            for b in np.unique(Space_ProcData['block']):
                #get block data
                block_data = Space_ProcData.loc[Space_ProcData['block'] == b]

                #re-do previous trial data base on just current block
                block_data['prev_state_earth'] = block_data['state_earth'].shift(1)
                block_data['prev_state_earth'] = np.where(np.isnan(block_data['prev_state_earth']), 0, block_data['prev_state_earth'])

                block_data['prev_state_planet'] = block_data['state_planet'].shift(1)
                block_data['prev_state_planet'] = np.where(np.isnan(block_data['prev_state_planet']), 0, block_data['prev_state_planet'])

                block_data['same_earth'] = np.where(block_data['state_earth'] == block_data['prev_state_earth'], 1, 0)
                block_data['same_planet'] = np.where(block_data['state_planet'] == block_data['prev_state_planet'], 1, 0)

                #get summary results
                block_trials_stat = summary_stats(block_data)
                block_trials_stat.insert(0, Space_ProcData.loc[0, 'sub'])
                block_trials_stat.insert(1, Space_ProcData.loc[0, 'ses'])

                block_name = 'b' + str(b)
                block_trials_stat.insert(2, block_name)

                #append new rows
                overall_summary_data.loc[len(overall_summary_data)] = block_trials_stat

            #update count for files loop
            count = 1

    else:
         overall_summary_data = 'no files'

    return overall_summary_data, space_group_trialsdat



Execution Outputs
-----------------


* group_trialdat : [    sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    89    2      1  ...                0.0           0            0
1    89    2      1  ...                1.0           1            0
2    89    2      1  ...                2.0           0            1
3    89    2      1  ...                2.0           0            0
4    89    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   89    2      4  ...                1.0           0            0
96   89    2      4  ...                2.0           0            0
97   89    2      4  ...                1.0           0            0
98   89    2      4  ...                2.0           0            0
99   89    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     1    2      1  ...                0.0           0            0
1     1    2      1  ...                1.0           1            0
2     1    2      1  ...                2.0           0            0
3     1    2      1  ...                1.0           1            1
4     1    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95    1    2      4  ...                2.0           0            1
96    1    2      4  ...                2.0           1            0
97    1    2      4  ...                1.0           0            1
98    1    2      4  ...                1.0           1            0
99    1    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    49    2      1  ...                0.0           0            0
1    49    2      1  ...                2.0           0            1
2    49    2      1  ...                2.0           0            0
3    49    2      1  ...                1.0           0            0
4    49    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   49    2      4  ...                1.0           1            1
96   49    2      4  ...                1.0           1            1
97   49    2      4  ...                1.0           1            1
98   49    2      4  ...                1.0           1            1
99   49    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    39    2      1  ...                0.0           0            0
1    39    2      1  ...                1.0           0            1
2    39    2      1  ...                1.0           1            0
3    39    2      1  ...                2.0           0            1
4    39    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   39    2      4  ...                2.0           1            0
96   39    2      4  ...                1.0           0            1
97   39    2      4  ...                1.0           0            1
98   39    2      4  ...                1.0           1            0
99   39    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    80    2      1  ...                0.0           0            0
1    80    2      1  ...                1.0           0            0
2    80    2      1  ...                2.0           1            0
3    80    2      1  ...                1.0           0            1
4    80    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   80    2      4  ...                1.0           0            1
96   80    2      4  ...                1.0           0            0
97   80    2      4  ...                2.0           0            0
98   80    2      4  ...                1.0           0            1
99   80    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     6    2      1  ...                0.0           0            0
1     6    2      1  ...                2.0           1            1
2     6    2      1  ...                2.0           1            1
3     6    2      1  ...                2.0           1            0
4     6    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95    6    2      4  ...                2.0           1            1
96    6    2      4  ...                2.0           1            1
97    6    2      4  ...                2.0           0            1
98    6    2      4  ...                2.0           0            0
99    6    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     2    2      1  ...                0.0           0            0
1     2    2      1  ...                2.0           0            1
2     2    2      1  ...                2.0           0            0
3     2    2      1  ...                1.0           0            1
4     2    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95    2    2      4  ...                1.0           1            1
96    2    2      4  ...                1.0           0            1
97    2    2      4  ...                1.0           1            0
98    2    2      4  ...                2.0           0            0
99    2    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    23    2      1  ...                0.0           0            0
1    23    2      1  ...                2.0           0            1
2    23    2      1  ...                2.0           0            0
3    23    2      1  ...                1.0           0            1
4    23    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   23    2      4  ...                1.0           1            1
96   23    2      4  ...                1.0           1            1
97   23    2      4  ...                1.0           1            1
98   23    2      4  ...                1.0           1            1
99   23    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    20    2      1  ...                0.0           0            0
1    20    2      1  ...                2.0           0            0
2    20    2      1  ...                1.0           1            1
3    20    2      1  ...                1.0           1            1
4    20    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   20    2      4  ...                1.0           0            0
96   20    2      4  ...                2.0           1            0
97   20    2      4  ...                1.0           0            0
98   20    2      4  ...                2.0           1            1
99   20    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    45    2      1  ...                0.0           0            0
1    45    2      1  ...                2.0           1            0
2    45    2      1  ...                1.0           1            1
3    45    2      1  ...                1.0           1            1
4    45    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   45    2      4  ...                2.0           1            0
96   45    2      4  ...                1.0           1            0
97   45    2      4  ...                2.0           0            0
98   45    2      4  ...                1.0           0            0
99   45    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     9    2      1  ...                0.0           0            0
1     9    2      1  ...                2.0           1            1
2     9    2      1  ...                2.0           1            1
3     9    2      1  ...                2.0           0            0
4     9    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95    9    2      4  ...                1.0           1            0
96    9    2      4  ...                2.0           0            0
97    9    2      4  ...                1.0           1            0
98    9    2      4  ...                2.0           0            0
99    9    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    74    2      1  ...                0.0           0            0
1    74    2      1  ...                2.0           0            1
2    74    2      1  ...                2.0           0            1
3    74    2      1  ...                2.0           1            0
4    74    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   74    2      4  ...                1.0           1            1
96   74    2      4  ...                1.0           1            1
97   74    2      4  ...                1.0           1            1
98   74    2      4  ...                1.0           0            0
99   74    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    73    2      1  ...                0.0           0            0
1    73    2      1  ...                1.0           1            0
2    73    2      1  ...                2.0           0            0
3    73    2      1  ...                1.0           1            0
4    73    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   73    2      4  ...                2.0           0            1
96   73    2      4  ...                2.0           0            1
97   73    2      4  ...                2.0           0            1
98   73    2      4  ...                2.0           0            0
99   73    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    94    2      1  ...                0.0           0            1
1    94    2      1  ...                0.0           0            1
2    94    2      1  ...                0.0           0            0
3    94    2      1  ...                2.0           1            1
4    94    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   94    2      4  ...                1.0           1            1
96   94    2      4  ...                1.0           1            0
97   94    2      4  ...                2.0           1            1
98   94    2      4  ...                2.0           0            0
99   94    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    28    2      1  ...                0.0           0            0
1    28    2      1  ...                1.0           1            1
2    28    2      1  ...                1.0           1            1
3    28    2      1  ...                1.0           1            0
4    28    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   28    2      4  ...                2.0           0            1
96   28    2      4  ...                2.0           1            1
97   28    2      4  ...                2.0           0            0
98   28    2      4  ...                1.0           1            1
99   28    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    54    2      1  ...                0.0           0            0
1    54    2      1  ...                1.0           1            1
2    54    2      1  ...                1.0           0            1
3    54    2      1  ...                1.0           1            1
4    54    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   54    2      4  ...                1.0           1            1
96   54    2      4  ...                1.0           1            1
97   54    2      4  ...                1.0           1            1
98   54    2      4  ...                1.0           0            1
99   54    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    19    2      1  ...                0.0           0            0
1    19    2      1  ...                2.0           0            0
2    19    2      1  ...                1.0           0            0
3    19    2      1  ...                2.0           0            0
4    19    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   19    2      4  ...                1.0           0            1
96   19    2      4  ...                1.0           0            0
97   19    2      4  ...                2.0           0            0
98   19    2      4  ...                1.0           0            1
99   19    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    41    2      1  ...                0.0           0            0
1    41    2      1  ...                2.0           0            0
2    41    2      1  ...                1.0           0            0
3    41    2      1  ...                2.0           0            0
4    41    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   41    2      4  ...                1.0           1            0
96   41    2      4  ...                2.0           0            0
97   41    2      4  ...                1.0           0            1
98   41    2      4  ...                1.0           1            1
99   41    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    95    2      1  ...                0.0           0            0
1    95    2      1  ...                2.0           1            0
2    95    2      1  ...                1.0           0            1
3    95    2      1  ...                1.0           0            0
4    95    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   95    2      4  ...                2.0           0            0
96   95    2      4  ...                1.0           0            0
97   95    2      4  ...                2.0           0            0
98   95    2      4  ...                1.0           0            1
99   95    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     5    2      1  ...                0.0           0            0
1     5    2      1  ...                2.0           1            0
2     5    2      1  ...                1.0           0            1
3     5    2      1  ...                1.0           1            0
4     5    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95    5    2      4  ...                2.0           0            0
96    5    2      4  ...                1.0           1            0
97    5    2      4  ...                2.0           0            1
98    5    2      4  ...                2.0           0            1
99    5    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    84    2      1  ...                0.0           0            0
1    84    2      1  ...                2.0           0            1
2    84    2      1  ...                2.0           1            1
3    84    2      1  ...                2.0           0            0
4    84    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   84    2      4  ...                1.0           1            1
96   84    2      4  ...                1.0           1            1
97   84    2      4  ...                1.0           0            1
98   84    2      4  ...                1.0           0            0
99   84    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    43    2      1  ...                0.0           0            0
1    43    2      1  ...                1.0           1            0
2    43    2      1  ...                2.0           0            0
3    43    2      1  ...                1.0           0            0
4    43    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   43    2      4  ...                2.0           0            0
96   43    2      4  ...                1.0           1            0
97   43    2      4  ...                2.0           1            1
98   43    2      4  ...                2.0           0            1
99   43    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     3    2      1  ...                0.0           0            0
1     3    2      1  ...                1.0           1            0
2     3    2      1  ...                2.0           1            1
3     3    2      1  ...                2.0           1            1
4     3    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95    3    2      4  ...                2.0           0            1
96    3    2      4  ...                2.0           1            1
97    3    2      4  ...                2.0           0            1
98    3    2      4  ...                2.0           0            1
99    3    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    55    2      1  ...                0.0           0            0
1    55    2      1  ...                2.0           0            1
2    55    2      1  ...                2.0           0            0
3    55    2      1  ...                1.0           0            1
4    55    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   55    2      4  ...                2.0           0            1
96   55    2      4  ...                2.0           0            1
97   55    2      4  ...                2.0           0            1
98   55    2      4  ...                2.0           0            1
99   55    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     7    2      1  ...                0.0           0            0
1     7    2      1  ...                1.0           0            0
2     7    2      1  ...                2.0           0            1
3     7    2      1  ...                2.0           1            0
4     7    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95    7    2      4  ...                0.0           0            0
96    7    2      4  ...                1.0           0            1
97    7    2      4  ...                1.0           1            0
98    7    2      4  ...                2.0           0            1
99    7    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    38    2      1  ...                0.0           0            0
1    38    2      1  ...                2.0           0            0
2    38    2      1  ...                1.0           1            1
3    38    2      1  ...                1.0           1            1
4    38    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   38    2      4  ...                1.0           1            1
96   38    2      4  ...                1.0           0            0
97   38    2      4  ...                2.0           0            1
98   38    2      4  ...                2.0           0            0
99   38    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    26    2      1  ...                0.0           0            0
1    26    2      1  ...                1.0           0            0
2    26    2      1  ...                2.0           1            0
3    26    2      1  ...                1.0           0            0
4    26    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   26    2      4  ...                2.0           0            1
96   26    2      4  ...                2.0           1            0
97   26    2      4  ...                1.0           0            1
98   26    2      4  ...                1.0           1            1
99   26    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    21    2      1  ...                0.0           0            0
1    21    2      1  ...                1.0           0            0
2    21    2      1  ...                2.0           1            0
3    21    2      1  ...                1.0           0            0
4    21    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   21    2      4  ...                2.0           1            0
96   21    2      4  ...                1.0           1            1
97   21    2      4  ...                1.0           1            0
98   21    2      4  ...                2.0           0            0
99   21    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    33    2      1  ...                0.0           0            0
1    33    2      1  ...                2.0           0            1
2    33    2      1  ...                2.0           1            0
3    33    2      1  ...                1.0           1            0
4    33    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   33    2      4  ...                1.0           1            1
96   33    2      4  ...                1.0           0            0
97   33    2      4  ...                2.0           1            1
98   33    2      4  ...                2.0           1            1
99   33    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    71    2      1  ...                0.0           0            0
1    71    2      1  ...                1.0           1            1
2    71    2      1  ...                1.0           1            1
3    71    2      1  ...                1.0           1            1
4    71    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   71    2      4  ...                1.0           0            1
96   71    2      4  ...                1.0           0            1
97   71    2      4  ...                1.0           0            1
98   71    2      4  ...                1.0           1            1
99   71    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    93    2      1  ...                0.0           0            0
1    93    2      1  ...                1.0           0            0
2    93    2      1  ...                2.0           0            0
3    93    2      1  ...                1.0           0            1
4    93    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   93    2      4  ...                0.0           0            1
96   93    2      4  ...                0.0           1            1
97   93    2      4  ...                0.0           0            0
98   93    2      4  ...                1.0           0            1
99   93    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    18    2      1  ...                0.0           0            0
1    18    2      1  ...                1.0           1            1
2    18    2      1  ...                1.0           0            1
3    18    2      1  ...                1.0           1            0
4    18    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   18    2      4  ...                2.0           0            1
96   18    2      4  ...                2.0           1            0
97   18    2      4  ...                1.0           0            0
98   18    2      4  ...                2.0           1            1
99   18    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    52    2      1  ...                0.0           0            0
1    52    2      1  ...                1.0           1            1
2    52    2      1  ...                1.0           1            0
3    52    2      1  ...                0.0           0            0
4    52    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   52    2      4  ...                1.0           0            0
96   52    2      4  ...                0.0           0            0
97   52    2      4  ...                2.0           0            0
98   52    2      4  ...                1.0           1            1
99   52    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    35    2      1  ...                0.0           0            0
1    35    2      1  ...                2.0           0            0
2    35    2      1  ...                1.0           1            1
3    35    2      1  ...                1.0           0            0
4    35    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   35    2      4  ...                1.0           1            0
96   35    2      4  ...                2.0           0            1
97   35    2      4  ...                2.0           0            0
98   35    2      4  ...                1.0           0            0
99   35    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    78    2      1  ...                0.0           0            0
1    78    2      1  ...                1.0           0            0
2    78    2      1  ...                2.0           0            0
3    78    2      1  ...                1.0           0            1
4    78    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   78    2      4  ...                2.0           0            0
96   78    2      4  ...                1.0           0            1
97   78    2      4  ...                1.0           0            0
98   78    2      4  ...                2.0           1            1
99   78    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    11    2      1  ...                0.0           0            0
1    11    2      1  ...                1.0           0            1
2    11    2      1  ...                1.0           1            1
3    11    2      1  ...                1.0           0            1
4    11    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   11    2      4  ...                1.0           1            1
96   11    2      4  ...                1.0           0            1
97   11    2      4  ...                1.0           1            1
98   11    2      4  ...                1.0           0            0
99   11    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    83    2      1  ...                0.0           0            0
1    83    2      1  ...                1.0           1            1
2    83    2      1  ...                1.0           1            0
3    83    2      1  ...                2.0           0            1
4    83    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   83    2      4  ...                2.0           1            0
96   83    2      4  ...                1.0           1            1
97   83    2      4  ...                1.0           1            0
98   83    2      4  ...                0.0           1            0
99   83    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    37    2      1  ...                0.0           0            1
1    37    2      1  ...                0.0           0            0
2    37    2      1  ...                1.0           1            0
3    37    2      1  ...                2.0           1            1
4    37    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   37    2      4  ...                2.0           1            0
96   37    2      4  ...                1.0           0            0
97   37    2      4  ...                2.0           0            1
98   37    2      4  ...                2.0           1            1
99   37    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    40    2      1  ...                0.0           0            0
1    40    2      1  ...                1.0           1            0
2    40    2      1  ...                2.0           0            1
3    40    2      1  ...                2.0           1            0
4    40    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   40    2      4  ...                2.0           1            0
96   40    2      4  ...                1.0           1            0
97   40    2      4  ...                2.0           1            0
98   40    2      4  ...                1.0           0            0
99   40    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    51    2      1  ...                0.0           0            0
1    51    2      1  ...                1.0           0            1
2    51    2      1  ...                1.0           0            1
3    51    2      1  ...                1.0           0            1
4    51    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   51    2      4  ...                1.0           1            1
96   51    2      4  ...                1.0           0            1
97   51    2      4  ...                1.0           1            0
98   51    2      4  ...                2.0           0            1
99   51    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    68    2      1  ...                0.0           0            0
1    68    2      1  ...                2.0           0            0
2    68    2      1  ...                1.0           1            1
3    68    2      1  ...                1.0           1            1
4    68    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   68    2      4  ...                1.0           0            1
96   68    2      4  ...                1.0           1            1
97   68    2      4  ...                1.0           0            1
98   68    2      4  ...                1.0           0            1
99   68    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    96    2      1  ...                0.0           0            0
1    96    2      1  ...                2.0           1            0
2    96    2      1  ...                1.0           0            1
3    96    2      1  ...                1.0           1            0
4    96    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   96    2      4  ...                1.0           0            0
96   96    2      4  ...                2.0           1            0
97   96    2      4  ...                1.0           0            1
98   96    2      4  ...                1.0           1            1
99   96    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    17    2      1  ...                0.0           0            0
1    17    2      1  ...                1.0           1            0
2    17    2      1  ...                2.0           1            0
3    17    2      1  ...                1.0           1            1
4    17    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   17    2      4  ...                1.0           0            0
96   17    2      4  ...                2.0           0            1
97   17    2      4  ...                2.0           0            1
98   17    2      4  ...                2.0           1            1
99   17    2      4  ...                2.0           0            0

[100 rows x 26 columns]]
* summarySpace_dat : [  sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  89   2  ...                      0.45                 0.396552
1  89   2  ...                       0.5                      0.5
2  89   2  ...                  0.428571                 0.545455
3  89   2  ...                  0.555556                   0.3125
4  89   2  ...                     0.375                   0.1875

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   1   2  ...                  0.425532                 0.489362
1   1   2  ...                     0.375                 0.411765
2   1   2  ...                  0.357143                 0.571429
3   1   2  ...                  0.583333                 0.454545
4   1   2  ...                  0.416667                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  49   2  ...                  0.571429                 0.435897
1  49   2  ...                  0.454545                 0.230769
2  49   2  ...                  0.615385                 0.555556
3  49   2  ...                  0.529412                    0.625
4  49   2  ...                  0.666667                 0.333333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  39   2  ...                   0.26087                 0.489796
1  39   2  ...                  0.272727                 0.454545
2  39   2  ...                  0.363636                 0.571429
3  39   2  ...                       0.3                 0.285714
4  39   2  ...                  0.166667                 0.583333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  80   2  ...                  0.710526                 0.583333
1  80   2  ...                  0.583333                 0.769231
2  80   2  ...                       0.9                 0.533333
3  80   2  ...                      0.75                      0.4
4  80   2  ...                  0.571429                 0.555556

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   6   2  ...                  0.866667                      0.7
1   6   2  ...                  0.846154                      0.6
2   6   2  ...                      0.75                      0.8
3   6   2  ...                       0.8                 0.533333
4   6   2  ...                       1.0                 0.692308

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   2   2  ...                  0.319149                 0.479167
1   2   2  ...                  0.461538                      0.3
2   2   2  ...                  0.333333                 0.533333
3   2   2  ...                  0.363636                 0.538462
4   2   2  ...                  0.153846                 0.363636

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  23   2  ...                       0.5                 0.488889
1  23   2  ...                       0.3                 0.272727
2  23   2  ...                  0.555556                 0.428571
3  23   2  ...                  0.333333                 0.529412
4  23   2  ...                      0.75                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  20   2  ...                  0.466667                 0.355556
1  20   2  ...                       0.5                 0.307692
2  20   2  ...                  0.666667                 0.777778
3  20   2  ...                  0.416667                      0.0
4  20   2  ...                  0.333333                 0.384615

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  45   2  ...                  0.488889                 0.444444
1  45   2  ...                  0.571429                      0.4
2  45   2  ...                  0.363636                 0.642857
3  45   2  ...                       0.4                 0.333333
4  45   2  ...                       0.6                 0.266667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   9   2  ...                  0.456522                      0.5
1   9   2  ...                  0.636364                 0.538462
2   9   2  ...                  0.363636                 0.357143
3   9   2  ...                       0.4                      0.5
4   9   2  ...                  0.461538                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  74   2  ...                  0.560976                 0.448276
1  74   2  ...                  0.444444                      0.5
2  74   2  ...                     0.375                    0.375
3  74   2  ...                     0.625                 0.470588
4  74   2  ...                  0.666667                      0.3

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  73   2  ...                  0.466667                 0.319149
1  73   2  ...                  0.470588                 0.166667
2  73   2  ...                  0.583333                 0.111111
3  73   2  ...                       0.5                   0.1875
4  73   2  ...                  0.333333                 0.555556

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  94   2  ...                  0.521739                     0.46
1  94   2  ...                  0.545455                 0.416667
2  94   2  ...                  0.636364                 0.538462
3  94   2  ...                  0.444444                      0.4
4  94   2  ...                  0.538462                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  28   2  ...                  0.583333                 0.645833
1  28   2  ...                  0.692308                 0.545455
2  28   2  ...                       0.6                    0.625
3  28   2  ...                  0.222222                 0.466667
4  28   2  ...                  0.777778                     0.75

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  54   2  ...                  0.590909                 0.510204
1  54   2  ...                       0.6                 0.384615
2  54   2  ...                  0.357143                 0.636364
3  54   2  ...                  0.714286                 0.466667
4  54   2  ...                       0.8                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  19   2  ...                       0.5                 0.315789
1  19   2  ...                  0.545455                 0.307692
2  19   2  ...                     0.375                 0.411765
3  19   2  ...                  0.583333                 0.166667
4  19   2  ...                  0.444444                 0.266667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  41   2  ...                  0.611111                      0.4
1  41   2  ...                       0.5                 0.230769
2  41   2  ...                  0.615385                 0.416667
3  41   2  ...                  0.642857                 0.363636
4  41   2  ...                  0.642857                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  95   2  ...                  0.194444                 0.423729
1  95   2  ...                  0.142857                 0.388889
2  95   2  ...                  0.153846                     0.25
3  95   2  ...                  0.166667                   0.4375
4  95   2  ...                     0.125                 0.466667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   5   2  ...                  0.391304                 0.509804
1   5   2  ...                  0.222222                 0.357143
2   5   2  ...                       0.4                 0.533333
3   5   2  ...                       0.5                     0.75
4   5   2  ...                  0.428571                 0.272727

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  84   2  ...                   0.45098                 0.458333
1  84   2  ...                  0.384615                 0.583333
2  84   2  ...                  0.538462                 0.454545
3  84   2  ...                  0.230769                 0.416667
4  84   2  ...                  0.636364                 0.357143

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  43   2  ...                      0.58                 0.612245
1  43   2  ...                  0.333333                 0.583333
2  43   2  ...                  0.461538                 0.583333
3  43   2  ...                       0.8                      0.6
4  43   2  ...                  0.785714                 0.636364

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   3   2  ...                  0.755102                 0.686275
1   3   2  ...                      0.75                 0.588235
2   3   2  ...                       0.8                      0.7
3   3   2  ...                  0.846154                 0.833333
4   3   2  ...                  0.666667                 0.615385

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  55   2  ...                       0.8                     0.75
1  55   2  ...                       0.5                 0.533333
2  55   2  ...                       1.0                 0.764706
3  55   2  ...                       0.9                 0.733333
4  55   2  ...                       0.8                      0.8

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   7   2  ...                  0.590909                      0.4
1   7   2  ...                  0.533333                 0.333333
2   7   2  ...                       0.7                 0.571429
3   7   2  ...                  0.666667                 0.285714
4   7   2  ...                  0.555556                 0.357143

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  38   2  ...                  0.867925                 0.765957
1  38   2  ...                  0.866667                      0.7
2  38   2  ...                  0.833333                 0.692308
3  38   2  ...                       0.9                 0.733333
4  38   2  ...                  0.923077                     0.75

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  26   2  ...                      0.48                 0.510638
1  26   2  ...                       0.5                 0.384615
2  26   2  ...                  0.428571                 0.444444
3  26   2  ...                  0.461538                 0.545455
4  26   2  ...                       0.6                 0.466667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  21   2  ...                  0.561404                  0.52381
1  21   2  ...                     0.625                    0.375
2  21   2  ...                    0.6875                 0.555556
3  21   2  ...                  0.272727                      0.5
4  21   2  ...                  0.538462                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  33   2  ...                  0.413043                 0.319149
1  33   2  ...                       0.3                 0.384615
2  33   2  ...                       0.4                 0.181818
3  33   2  ...                  0.416667                 0.230769
4  33   2  ...                       0.5                      0.3

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  71   2  ...                      0.66                 0.479167
1  71   2  ...                  0.846154                      0.5
2  71   2  ...                  0.615385                 0.272727
3  71   2  ...                  0.545455                 0.384615
4  71   2  ...                  0.727273                 0.642857

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  93   2  ...                  0.444444                 0.411765
1  93   2  ...                  0.545455                 0.357143
2  93   2  ...                     0.375                 0.333333
3  93   2  ...                  0.363636                 0.545455
4  93   2  ...                       0.4                      0.4

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  18   2  ...                       0.5                 0.565217
1  18   2  ...                  0.461538                     0.75
2  18   2  ...                       0.5                 0.384615
3  18   2  ...                  0.454545                 0.384615
4  18   2  ...                  0.571429                      0.6

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  52   2  ...                   0.55814                 0.404255
1  52   2  ...                  0.571429                 0.333333
2  52   2  ...                  0.461538                 0.636364
3  52   2  ...                       0.8                 0.294118
4  52   2  ...                  0.555556                 0.333333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  35   2  ...                  0.454545                 0.367347
1  35   2  ...                  0.142857                 0.133333
2  35   2  ...                  0.666667                      0.5
3  35   2  ...                  0.533333                 0.222222
4  35   2  ...                  0.272727                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  78   2  ...                  0.583333                 0.519231
1  78   2  ...                  0.555556                      0.5
2  78   2  ...                  0.733333                      0.6
3  78   2  ...                  0.461538                      0.5
4  78   2  ...                  0.545455                 0.428571

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  11   2  ...                  0.836735                  0.72549
1  11   2  ...                     0.875                 0.777778
2  11   2  ...                  0.769231                 0.916667
3  11   2  ...                  0.888889                   0.4375
4  11   2  ...                       0.8                 0.666667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  83   2  ...                   0.45283                 0.533333
1  83   2  ...                  0.352941                 0.571429
2  83   2  ...                  0.615385                      0.5
3  83   2  ...                  0.545455                 0.428571
4  83   2  ...                       0.2                 0.571429

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  37   2  ...                  0.557692                 0.305556
1  37   2  ...                       0.7                 0.222222
2  37   2  ...                  0.363636                      0.2
3  37   2  ...                  0.571429                      0.3
4  37   2  ...                       0.6                 0.444444

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  40   2  ...                      0.42                    0.625
1  40   2  ...                       0.2                 0.571429
2  40   2  ...                    0.4375                 0.666667
3  40   2  ...                       0.6                 0.666667
4  40   2  ...                  0.461538                 0.454545

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  51   2  ...                       0.5                 0.588235
1  51   2  ...                      0.25                   0.6875
2  51   2  ...                  0.636364                      0.5
3  51   2  ...                  0.615385                 0.545455
4  51   2  ...                  0.363636                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  68   2  ...                  0.568182                  0.44186
1  68   2  ...                     0.625                   0.5625
2  68   2  ...                  0.333333                 0.166667
3  68   2  ...                  0.454545                 0.222222
4  68   2  ...                       1.0                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  96   2  ...                      0.48                 0.565217
1  96   2  ...                  0.466667                      0.5
2  96   2  ...                       0.6                 0.538462
3  96   2  ...                       0.3                 0.538462
4  96   2  ...                  0.571429                 0.545455

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  17   2  ...                      0.52                 0.458333
1  17   2  ...                  0.538462                 0.583333
2  17   2  ...                  0.461538                      0.5
3  17   2  ...                  0.615385                 0.333333
4  17   2  ...                       0.5                 0.384615

[5 rows x 16 columns]]


Subnode reports
---------------


 subnode 0 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData0/_report/report.rst
 subnode 1 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData1/_report/report.rst
 subnode 2 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData2/_report/report.rst
 subnode 3 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData3/_report/report.rst
 subnode 4 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData4/_report/report.rst
 subnode 5 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData5/_report/report.rst
 subnode 6 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData6/_report/report.rst
 subnode 7 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData7/_report/report.rst
 subnode 8 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData8/_report/report.rst
 subnode 9 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData9/_report/report.rst
 subnode 10 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData10/_report/report.rst
 subnode 11 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData11/_report/report.rst
 subnode 12 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData12/_report/report.rst
 subnode 13 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData13/_report/report.rst
 subnode 14 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData14/_report/report.rst
 subnode 15 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData15/_report/report.rst
 subnode 16 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData16/_report/report.rst
 subnode 17 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData17/_report/report.rst
 subnode 18 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData18/_report/report.rst
 subnode 19 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData19/_report/report.rst
 subnode 20 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData20/_report/report.rst
 subnode 21 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData21/_report/report.rst
 subnode 22 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData22/_report/report.rst
 subnode 23 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData23/_report/report.rst
 subnode 24 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData24/_report/report.rst
 subnode 25 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData25/_report/report.rst
 subnode 26 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData26/_report/report.rst
 subnode 27 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData27/_report/report.rst
 subnode 28 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData28/_report/report.rst
 subnode 29 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData29/_report/report.rst
 subnode 30 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData30/_report/report.rst
 subnode 31 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData31/_report/report.rst
 subnode 32 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData32/_report/report.rst
 subnode 33 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData33/_report/report.rst
 subnode 34 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData34/_report/report.rst
 subnode 35 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData35/_report/report.rst
 subnode 36 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData36/_report/report.rst
 subnode 37 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData37/_report/report.rst
 subnode 38 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData38/_report/report.rst
 subnode 39 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData39/_report/report.rst
 subnode 40 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData40/_report/report.rst
 subnode 41 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData41/_report/report.rst
 subnode 42 : /Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/SpaceGame/_session_id_2/summaryData/mapflow/_summaryData42/_report/report.rst

