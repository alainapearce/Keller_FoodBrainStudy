[('Space_group_trialdat', [    sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    89    2      1  ...                0.0           0            0
1    89    2      1  ...                1.0           1            0
2    89    2      1  ...                2.0           0            1
3    89    2      1  ...                2.0           0            0
4    89    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   89    2      4  ...                1.0           0            0
96   89    2      4  ...                2.0           0            0
97   89    2      4  ...                1.0           0            0
98   89    2      4  ...                2.0           0            0
99   89    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     1    2      1  ...                0.0           0            0
1     1    2      1  ...                1.0           1            0
2     1    2      1  ...                2.0           0            0
3     1    2      1  ...                1.0           1            1
4     1    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95    1    2      4  ...                2.0           0            1
96    1    2      4  ...                2.0           1            0
97    1    2      4  ...                1.0           0            1
98    1    2      4  ...                1.0           1            0
99    1    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    49    2      1  ...                0.0           0            0
1    49    2      1  ...                2.0           0            1
2    49    2      1  ...                2.0           0            0
3    49    2      1  ...                1.0           0            0
4    49    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   49    2      4  ...                1.0           1            1
96   49    2      4  ...                1.0           1            1
97   49    2      4  ...                1.0           1            1
98   49    2      4  ...                1.0           1            1
99   49    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    39    2      1  ...                0.0           0            0
1    39    2      1  ...                1.0           0            1
2    39    2      1  ...                1.0           1            0
3    39    2      1  ...                2.0           0            1
4    39    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   39    2      4  ...                2.0           1            0
96   39    2      4  ...                1.0           0            1
97   39    2      4  ...                1.0           0            1
98   39    2      4  ...                1.0           1            0
99   39    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    80    2      1  ...                0.0           0            0
1    80    2      1  ...                1.0           0            0
2    80    2      1  ...                2.0           1            0
3    80    2      1  ...                1.0           0            1
4    80    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   80    2      4  ...                1.0           0            1
96   80    2      4  ...                1.0           0            0
97   80    2      4  ...                2.0           0            0
98   80    2      4  ...                1.0           0            1
99   80    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     6    2      1  ...                0.0           0            0
1     6    2      1  ...                2.0           1            1
2     6    2      1  ...                2.0           1            1
3     6    2      1  ...                2.0           1            0
4     6    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95    6    2      4  ...                2.0           1            1
96    6    2      4  ...                2.0           1            1
97    6    2      4  ...                2.0           0            1
98    6    2      4  ...                2.0           0            0
99    6    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     2    2      1  ...                0.0           0            0
1     2    2      1  ...                2.0           0            1
2     2    2      1  ...                2.0           0            0
3     2    2      1  ...                1.0           0            1
4     2    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95    2    2      4  ...                1.0           1            1
96    2    2      4  ...                1.0           0            1
97    2    2      4  ...                1.0           1            0
98    2    2      4  ...                2.0           0            0
99    2    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    23    2      1  ...                0.0           0            0
1    23    2      1  ...                2.0           0            1
2    23    2      1  ...                2.0           0            0
3    23    2      1  ...                1.0           0            1
4    23    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   23    2      4  ...                1.0           1            1
96   23    2      4  ...                1.0           1            1
97   23    2      4  ...                1.0           1            1
98   23    2      4  ...                1.0           1            1
99   23    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    20    2      1  ...                0.0           0            0
1    20    2      1  ...                2.0           0            0
2    20    2      1  ...                1.0           1            1
3    20    2      1  ...                1.0           1            1
4    20    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   20    2      4  ...                1.0           0            0
96   20    2      4  ...                2.0           1            0
97   20    2      4  ...                1.0           0            0
98   20    2      4  ...                2.0           1            1
99   20    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    45    2      1  ...                0.0           0            0
1    45    2      1  ...                2.0           1            0
2    45    2      1  ...                1.0           1            1
3    45    2      1  ...                1.0           1            1
4    45    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   45    2      4  ...                2.0           1            0
96   45    2      4  ...                1.0           1            0
97   45    2      4  ...                2.0           0            0
98   45    2      4  ...                1.0           0            0
99   45    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     9    2      1  ...                0.0           0            0
1     9    2      1  ...                2.0           1            1
2     9    2      1  ...                2.0           1            1
3     9    2      1  ...                2.0           0            0
4     9    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95    9    2      4  ...                1.0           1            0
96    9    2      4  ...                2.0           0            0
97    9    2      4  ...                1.0           1            0
98    9    2      4  ...                2.0           0            0
99    9    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    74    2      1  ...                0.0           0            0
1    74    2      1  ...                2.0           0            1
2    74    2      1  ...                2.0           0            1
3    74    2      1  ...                2.0           1            0
4    74    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   74    2      4  ...                1.0           1            1
96   74    2      4  ...                1.0           1            1
97   74    2      4  ...                1.0           1            1
98   74    2      4  ...                1.0           0            0
99   74    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    73    2      1  ...                0.0           0            0
1    73    2      1  ...                1.0           1            0
2    73    2      1  ...                2.0           0            0
3    73    2      1  ...                1.0           1            0
4    73    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   73    2      4  ...                2.0           0            1
96   73    2      4  ...                2.0           0            1
97   73    2      4  ...                2.0           0            1
98   73    2      4  ...                2.0           0            0
99   73    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    94    2      1  ...                0.0           0            1
1    94    2      1  ...                0.0           0            1
2    94    2      1  ...                0.0           0            0
3    94    2      1  ...                2.0           1            1
4    94    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   94    2      4  ...                1.0           1            1
96   94    2      4  ...                1.0           1            0
97   94    2      4  ...                2.0           1            1
98   94    2      4  ...                2.0           0            0
99   94    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    28    2      1  ...                0.0           0            0
1    28    2      1  ...                1.0           1            1
2    28    2      1  ...                1.0           1            1
3    28    2      1  ...                1.0           1            0
4    28    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   28    2      4  ...                2.0           0            1
96   28    2      4  ...                2.0           1            1
97   28    2      4  ...                2.0           0            0
98   28    2      4  ...                1.0           1            1
99   28    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    54    2      1  ...                0.0           0            0
1    54    2      1  ...                1.0           1            1
2    54    2      1  ...                1.0           0            1
3    54    2      1  ...                1.0           1            1
4    54    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   54    2      4  ...                1.0           1            1
96   54    2      4  ...                1.0           1            1
97   54    2      4  ...                1.0           1            1
98   54    2      4  ...                1.0           0            1
99   54    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    19    2      1  ...                0.0           0            0
1    19    2      1  ...                2.0           0            0
2    19    2      1  ...                1.0           0            0
3    19    2      1  ...                2.0           0            0
4    19    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   19    2      4  ...                1.0           0            1
96   19    2      4  ...                1.0           0            0
97   19    2      4  ...                2.0           0            0
98   19    2      4  ...                1.0           0            1
99   19    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    41    2      1  ...                0.0           0            0
1    41    2      1  ...                2.0           0            0
2    41    2      1  ...                1.0           0            0
3    41    2      1  ...                2.0           0            0
4    41    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   41    2      4  ...                1.0           1            0
96   41    2      4  ...                2.0           0            0
97   41    2      4  ...                1.0           0            1
98   41    2      4  ...                1.0           1            1
99   41    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    95    2      1  ...                0.0           0            0
1    95    2      1  ...                2.0           1            0
2    95    2      1  ...                1.0           0            1
3    95    2      1  ...                1.0           0            0
4    95    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   95    2      4  ...                2.0           0            0
96   95    2      4  ...                1.0           0            0
97   95    2      4  ...                2.0           0            0
98   95    2      4  ...                1.0           0            1
99   95    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     5    2      1  ...                0.0           0            0
1     5    2      1  ...                2.0           1            0
2     5    2      1  ...                1.0           0            1
3     5    2      1  ...                1.0           1            0
4     5    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95    5    2      4  ...                2.0           0            0
96    5    2      4  ...                1.0           1            0
97    5    2      4  ...                2.0           0            1
98    5    2      4  ...                2.0           0            1
99    5    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    84    2      1  ...                0.0           0            0
1    84    2      1  ...                2.0           0            1
2    84    2      1  ...                2.0           1            1
3    84    2      1  ...                2.0           0            0
4    84    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   84    2      4  ...                1.0           1            1
96   84    2      4  ...                1.0           1            1
97   84    2      4  ...                1.0           0            1
98   84    2      4  ...                1.0           0            0
99   84    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    43    2      1  ...                0.0           0            0
1    43    2      1  ...                1.0           1            0
2    43    2      1  ...                2.0           0            0
3    43    2      1  ...                1.0           0            0
4    43    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   43    2      4  ...                2.0           0            0
96   43    2      4  ...                1.0           1            0
97   43    2      4  ...                2.0           1            1
98   43    2      4  ...                2.0           0            1
99   43    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     3    2      1  ...                0.0           0            0
1     3    2      1  ...                1.0           1            0
2     3    2      1  ...                2.0           1            1
3     3    2      1  ...                2.0           1            1
4     3    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95    3    2      4  ...                2.0           0            1
96    3    2      4  ...                2.0           1            1
97    3    2      4  ...                2.0           0            1
98    3    2      4  ...                2.0           0            1
99    3    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    55    2      1  ...                0.0           0            0
1    55    2      1  ...                2.0           0            1
2    55    2      1  ...                2.0           0            0
3    55    2      1  ...                1.0           0            1
4    55    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   55    2      4  ...                2.0           0            1
96   55    2      4  ...                2.0           0            1
97   55    2      4  ...                2.0           0            1
98   55    2      4  ...                2.0           0            1
99   55    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0     7    2      1  ...                0.0           0            0
1     7    2      1  ...                1.0           0            0
2     7    2      1  ...                2.0           0            1
3     7    2      1  ...                2.0           1            0
4     7    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95    7    2      4  ...                0.0           0            0
96    7    2      4  ...                1.0           0            1
97    7    2      4  ...                1.0           1            0
98    7    2      4  ...                2.0           0            1
99    7    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    38    2      1  ...                0.0           0            0
1    38    2      1  ...                2.0           0            0
2    38    2      1  ...                1.0           1            1
3    38    2      1  ...                1.0           1            1
4    38    2      1  ...                1.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   38    2      4  ...                1.0           1            1
96   38    2      4  ...                1.0           0            0
97   38    2      4  ...                2.0           0            1
98   38    2      4  ...                2.0           0            0
99   38    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    26    2      1  ...                0.0           0            0
1    26    2      1  ...                1.0           0            0
2    26    2      1  ...                2.0           1            0
3    26    2      1  ...                1.0           0            0
4    26    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   26    2      4  ...                2.0           0            1
96   26    2      4  ...                2.0           1            0
97   26    2      4  ...                1.0           0            1
98   26    2      4  ...                1.0           1            1
99   26    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    21    2      1  ...                0.0           0            0
1    21    2      1  ...                1.0           0            0
2    21    2      1  ...                2.0           1            0
3    21    2      1  ...                1.0           0            0
4    21    2      1  ...                2.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   21    2      4  ...                2.0           1            0
96   21    2      4  ...                1.0           1            1
97   21    2      4  ...                1.0           1            0
98   21    2      4  ...                2.0           0            0
99   21    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    33    2      1  ...                0.0           0            0
1    33    2      1  ...                2.0           0            1
2    33    2      1  ...                2.0           1            0
3    33    2      1  ...                1.0           1            0
4    33    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   33    2      4  ...                1.0           1            1
96   33    2      4  ...                1.0           0            0
97   33    2      4  ...                2.0           1            1
98   33    2      4  ...                2.0           1            1
99   33    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    71    2      1  ...                0.0           0            0
1    71    2      1  ...                1.0           1            1
2    71    2      1  ...                1.0           1            1
3    71    2      1  ...                1.0           1            1
4    71    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   71    2      4  ...                1.0           0            1
96   71    2      4  ...                1.0           0            1
97   71    2      4  ...                1.0           0            1
98   71    2      4  ...                1.0           1            1
99   71    2      4  ...                1.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    93    2      1  ...                0.0           0            0
1    93    2      1  ...                1.0           0            0
2    93    2      1  ...                2.0           0            0
3    93    2      1  ...                1.0           0            1
4    93    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   93    2      4  ...                0.0           0            1
96   93    2      4  ...                0.0           1            1
97   93    2      4  ...                0.0           0            0
98   93    2      4  ...                1.0           0            1
99   93    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    18    2      1  ...                0.0           0            0
1    18    2      1  ...                1.0           1            1
2    18    2      1  ...                1.0           0            1
3    18    2      1  ...                1.0           1            0
4    18    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   18    2      4  ...                2.0           0            1
96   18    2      4  ...                2.0           1            0
97   18    2      4  ...                1.0           0            0
98   18    2      4  ...                2.0           1            1
99   18    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    52    2      1  ...                0.0           0            0
1    52    2      1  ...                1.0           1            1
2    52    2      1  ...                1.0           1            0
3    52    2      1  ...                0.0           0            0
4    52    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   52    2      4  ...                1.0           0            0
96   52    2      4  ...                0.0           0            0
97   52    2      4  ...                2.0           0            0
98   52    2      4  ...                1.0           1            1
99   52    2      4  ...                1.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    35    2      1  ...                0.0           0            0
1    35    2      1  ...                2.0           0            0
2    35    2      1  ...                1.0           1            1
3    35    2      1  ...                1.0           0            0
4    35    2      1  ...                2.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   35    2      4  ...                1.0           1            0
96   35    2      4  ...                2.0           0            1
97   35    2      4  ...                2.0           0            0
98   35    2      4  ...                1.0           0            0
99   35    2      4  ...                2.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    78    2      1  ...                0.0           0            0
1    78    2      1  ...                1.0           0            0
2    78    2      1  ...                2.0           0            0
3    78    2      1  ...                1.0           0            1
4    78    2      1  ...                1.0           0            0
..  ...  ...    ...  ...                ...         ...          ...
95   78    2      4  ...                2.0           0            0
96   78    2      4  ...                1.0           0            1
97   78    2      4  ...                1.0           0            0
98   78    2      4  ...                2.0           1            1
99   78    2      4  ...                2.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    11    2      1  ...                0.0           0            0
1    11    2      1  ...                1.0           0            1
2    11    2      1  ...                1.0           1            1
3    11    2      1  ...                1.0           0            1
4    11    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   11    2      4  ...                1.0           1            1
96   11    2      4  ...                1.0           0            1
97   11    2      4  ...                1.0           1            1
98   11    2      4  ...                1.0           0            0
99   11    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    83    2      1  ...                0.0           0            0
1    83    2      1  ...                1.0           1            1
2    83    2      1  ...                1.0           1            0
3    83    2      1  ...                2.0           0            1
4    83    2      1  ...                2.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   83    2      4  ...                2.0           1            0
96   83    2      4  ...                1.0           1            1
97   83    2      4  ...                1.0           1            0
98   83    2      4  ...                0.0           1            0
99   83    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    37    2      1  ...                0.0           0            1
1    37    2      1  ...                0.0           0            0
2    37    2      1  ...                1.0           1            0
3    37    2      1  ...                2.0           1            1
4    37    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   37    2      4  ...                2.0           1            0
96   37    2      4  ...                1.0           0            0
97   37    2      4  ...                2.0           0            1
98   37    2      4  ...                2.0           1            1
99   37    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    40    2      1  ...                0.0           0            0
1    40    2      1  ...                1.0           1            0
2    40    2      1  ...                2.0           0            1
3    40    2      1  ...                2.0           1            0
4    40    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   40    2      4  ...                2.0           1            0
96   40    2      4  ...                1.0           1            0
97   40    2      4  ...                2.0           1            0
98   40    2      4  ...                1.0           0            0
99   40    2      4  ...                2.0           1            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    51    2      1  ...                0.0           0            0
1    51    2      1  ...                1.0           0            1
2    51    2      1  ...                1.0           0            1
3    51    2      1  ...                1.0           0            1
4    51    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   51    2      4  ...                1.0           1            1
96   51    2      4  ...                1.0           0            1
97   51    2      4  ...                1.0           1            0
98   51    2      4  ...                2.0           0            1
99   51    2      4  ...                2.0           0            1

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    68    2      1  ...                0.0           0            0
1    68    2      1  ...                2.0           0            0
2    68    2      1  ...                1.0           1            1
3    68    2      1  ...                1.0           1            1
4    68    2      1  ...                1.0           1            0
..  ...  ...    ...  ...                ...         ...          ...
95   68    2      4  ...                1.0           0            1
96   68    2      4  ...                1.0           1            1
97   68    2      4  ...                1.0           0            1
98   68    2      4  ...                1.0           0            1
99   68    2      4  ...                1.0           0            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    96    2      1  ...                0.0           0            0
1    96    2      1  ...                2.0           1            0
2    96    2      1  ...                1.0           0            1
3    96    2      1  ...                1.0           1            0
4    96    2      1  ...                2.0           1            1
..  ...  ...    ...  ...                ...         ...          ...
95   96    2      4  ...                1.0           0            0
96   96    2      4  ...                2.0           1            0
97   96    2      4  ...                1.0           0            1
98   96    2      4  ...                1.0           1            1
99   96    2      4  ...                1.0           1            0

[100 rows x 26 columns],     sub  ses  block  ...  prev_state_planet  same_earth  same_planet
0    17    2      1  ...                0.0           0            0
1    17    2      1  ...                1.0           1            0
2    17    2      1  ...                2.0           1            0
3    17    2      1  ...                1.0           1            1
4    17    2      1  ...                1.0           0            1
..  ...  ...    ...  ...                ...         ...          ...
95   17    2      4  ...                1.0           0            0
96   17    2      4  ...                2.0           0            1
97   17    2      4  ...                2.0           0            1
98   17    2      4  ...                2.0           1            1
99   17    2      4  ...                2.0           0            0

[100 rows x 26 columns]]), ('Space_summary_dat', [  sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  89   2  ...                      0.45                 0.396552
1  89   2  ...                       0.5                      0.5
2  89   2  ...                  0.428571                 0.545455
3  89   2  ...                  0.555556                   0.3125
4  89   2  ...                     0.375                   0.1875

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   1   2  ...                  0.425532                 0.489362
1   1   2  ...                     0.375                 0.411765
2   1   2  ...                  0.357143                 0.571429
3   1   2  ...                  0.583333                 0.454545
4   1   2  ...                  0.416667                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  49   2  ...                  0.571429                 0.435897
1  49   2  ...                  0.454545                 0.230769
2  49   2  ...                  0.615385                 0.555556
3  49   2  ...                  0.529412                    0.625
4  49   2  ...                  0.666667                 0.333333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  39   2  ...                   0.26087                 0.489796
1  39   2  ...                  0.272727                 0.454545
2  39   2  ...                  0.363636                 0.571429
3  39   2  ...                       0.3                 0.285714
4  39   2  ...                  0.166667                 0.583333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  80   2  ...                  0.710526                 0.583333
1  80   2  ...                  0.583333                 0.769231
2  80   2  ...                       0.9                 0.533333
3  80   2  ...                      0.75                      0.4
4  80   2  ...                  0.571429                 0.555556

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   6   2  ...                  0.866667                      0.7
1   6   2  ...                  0.846154                      0.6
2   6   2  ...                      0.75                      0.8
3   6   2  ...                       0.8                 0.533333
4   6   2  ...                       1.0                 0.692308

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   2   2  ...                  0.319149                 0.479167
1   2   2  ...                  0.461538                      0.3
2   2   2  ...                  0.333333                 0.533333
3   2   2  ...                  0.363636                 0.538462
4   2   2  ...                  0.153846                 0.363636

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  23   2  ...                       0.5                 0.488889
1  23   2  ...                       0.3                 0.272727
2  23   2  ...                  0.555556                 0.428571
3  23   2  ...                  0.333333                 0.529412
4  23   2  ...                      0.75                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  20   2  ...                  0.466667                 0.355556
1  20   2  ...                       0.5                 0.307692
2  20   2  ...                  0.666667                 0.777778
3  20   2  ...                  0.416667                      0.0
4  20   2  ...                  0.333333                 0.384615

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  45   2  ...                  0.488889                 0.444444
1  45   2  ...                  0.571429                      0.4
2  45   2  ...                  0.363636                 0.642857
3  45   2  ...                       0.4                 0.333333
4  45   2  ...                       0.6                 0.266667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   9   2  ...                  0.456522                      0.5
1   9   2  ...                  0.636364                 0.538462
2   9   2  ...                  0.363636                 0.357143
3   9   2  ...                       0.4                      0.5
4   9   2  ...                  0.461538                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  74   2  ...                  0.560976                 0.448276
1  74   2  ...                  0.444444                      0.5
2  74   2  ...                     0.375                    0.375
3  74   2  ...                     0.625                 0.470588
4  74   2  ...                  0.666667                      0.3

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  73   2  ...                  0.466667                 0.319149
1  73   2  ...                  0.470588                 0.166667
2  73   2  ...                  0.583333                 0.111111
3  73   2  ...                       0.5                   0.1875
4  73   2  ...                  0.333333                 0.555556

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  94   2  ...                  0.521739                     0.46
1  94   2  ...                  0.545455                 0.416667
2  94   2  ...                  0.636364                 0.538462
3  94   2  ...                  0.444444                      0.4
4  94   2  ...                  0.538462                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  28   2  ...                  0.583333                 0.645833
1  28   2  ...                  0.692308                 0.545455
2  28   2  ...                       0.6                    0.625
3  28   2  ...                  0.222222                 0.466667
4  28   2  ...                  0.777778                     0.75

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  54   2  ...                  0.590909                 0.510204
1  54   2  ...                       0.6                 0.384615
2  54   2  ...                  0.357143                 0.636364
3  54   2  ...                  0.714286                 0.466667
4  54   2  ...                       0.8                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  19   2  ...                       0.5                 0.315789
1  19   2  ...                  0.545455                 0.307692
2  19   2  ...                     0.375                 0.411765
3  19   2  ...                  0.583333                 0.166667
4  19   2  ...                  0.444444                 0.266667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  41   2  ...                  0.611111                      0.4
1  41   2  ...                       0.5                 0.230769
2  41   2  ...                  0.615385                 0.416667
3  41   2  ...                  0.642857                 0.363636
4  41   2  ...                  0.642857                      0.5

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  95   2  ...                  0.194444                 0.423729
1  95   2  ...                  0.142857                 0.388889
2  95   2  ...                  0.153846                     0.25
3  95   2  ...                  0.166667                   0.4375
4  95   2  ...                     0.125                 0.466667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   5   2  ...                  0.391304                 0.509804
1   5   2  ...                  0.222222                 0.357143
2   5   2  ...                       0.4                 0.533333
3   5   2  ...                       0.5                     0.75
4   5   2  ...                  0.428571                 0.272727

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  84   2  ...                   0.45098                 0.458333
1  84   2  ...                  0.384615                 0.583333
2  84   2  ...                  0.538462                 0.454545
3  84   2  ...                  0.230769                 0.416667
4  84   2  ...                  0.636364                 0.357143

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  43   2  ...                      0.58                 0.612245
1  43   2  ...                  0.333333                 0.583333
2  43   2  ...                  0.461538                 0.583333
3  43   2  ...                       0.8                      0.6
4  43   2  ...                  0.785714                 0.636364

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   3   2  ...                  0.755102                 0.686275
1   3   2  ...                      0.75                 0.588235
2   3   2  ...                       0.8                      0.7
3   3   2  ...                  0.846154                 0.833333
4   3   2  ...                  0.666667                 0.615385

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  55   2  ...                       0.8                     0.75
1  55   2  ...                       0.5                 0.533333
2  55   2  ...                       1.0                 0.764706
3  55   2  ...                       0.9                 0.733333
4  55   2  ...                       0.8                      0.8

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0   7   2  ...                  0.590909                      0.4
1   7   2  ...                  0.533333                 0.333333
2   7   2  ...                       0.7                 0.571429
3   7   2  ...                  0.666667                 0.285714
4   7   2  ...                  0.555556                 0.357143

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  38   2  ...                  0.867925                 0.765957
1  38   2  ...                  0.866667                      0.7
2  38   2  ...                  0.833333                 0.692308
3  38   2  ...                       0.9                 0.733333
4  38   2  ...                  0.923077                     0.75

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  26   2  ...                      0.48                 0.510638
1  26   2  ...                       0.5                 0.384615
2  26   2  ...                  0.428571                 0.444444
3  26   2  ...                  0.461538                 0.545455
4  26   2  ...                       0.6                 0.466667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  21   2  ...                  0.561404                  0.52381
1  21   2  ...                     0.625                    0.375
2  21   2  ...                    0.6875                 0.555556
3  21   2  ...                  0.272727                      0.5
4  21   2  ...                  0.538462                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  33   2  ...                  0.413043                 0.319149
1  33   2  ...                       0.3                 0.384615
2  33   2  ...                       0.4                 0.181818
3  33   2  ...                  0.416667                 0.230769
4  33   2  ...                       0.5                      0.3

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  71   2  ...                      0.66                 0.479167
1  71   2  ...                  0.846154                      0.5
2  71   2  ...                  0.615385                 0.272727
3  71   2  ...                  0.545455                 0.384615
4  71   2  ...                  0.727273                 0.642857

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  93   2  ...                  0.444444                 0.411765
1  93   2  ...                  0.545455                 0.357143
2  93   2  ...                     0.375                 0.333333
3  93   2  ...                  0.363636                 0.545455
4  93   2  ...                       0.4                      0.4

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  18   2  ...                       0.5                 0.565217
1  18   2  ...                  0.461538                     0.75
2  18   2  ...                       0.5                 0.384615
3  18   2  ...                  0.454545                 0.384615
4  18   2  ...                  0.571429                      0.6

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  52   2  ...                   0.55814                 0.404255
1  52   2  ...                  0.571429                 0.333333
2  52   2  ...                  0.461538                 0.636364
3  52   2  ...                       0.8                 0.294118
4  52   2  ...                  0.555556                 0.333333

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  35   2  ...                  0.454545                 0.367347
1  35   2  ...                  0.142857                 0.133333
2  35   2  ...                  0.666667                      0.5
3  35   2  ...                  0.533333                 0.222222
4  35   2  ...                  0.272727                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  78   2  ...                  0.583333                 0.519231
1  78   2  ...                  0.555556                      0.5
2  78   2  ...                  0.733333                      0.6
3  78   2  ...                  0.461538                      0.5
4  78   2  ...                  0.545455                 0.428571

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  11   2  ...                  0.836735                  0.72549
1  11   2  ...                     0.875                 0.777778
2  11   2  ...                  0.769231                 0.916667
3  11   2  ...                  0.888889                   0.4375
4  11   2  ...                       0.8                 0.666667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  83   2  ...                   0.45283                 0.533333
1  83   2  ...                  0.352941                 0.571429
2  83   2  ...                  0.615385                      0.5
3  83   2  ...                  0.545455                 0.428571
4  83   2  ...                       0.2                 0.571429

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  37   2  ...                  0.557692                 0.305556
1  37   2  ...                       0.7                 0.222222
2  37   2  ...                  0.363636                      0.2
3  37   2  ...                  0.571429                      0.3
4  37   2  ...                       0.6                 0.444444

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  40   2  ...                      0.42                    0.625
1  40   2  ...                       0.2                 0.571429
2  40   2  ...                    0.4375                 0.666667
3  40   2  ...                       0.6                 0.666667
4  40   2  ...                  0.461538                 0.454545

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  51   2  ...                       0.5                 0.588235
1  51   2  ...                      0.25                   0.6875
2  51   2  ...                  0.636364                      0.5
3  51   2  ...                  0.615385                 0.545455
4  51   2  ...                  0.363636                 0.461538

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  68   2  ...                  0.568182                  0.44186
1  68   2  ...                     0.625                   0.5625
2  68   2  ...                  0.333333                 0.166667
3  68   2  ...                  0.454545                 0.222222
4  68   2  ...                       1.0                 0.416667

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  96   2  ...                      0.48                 0.565217
1  96   2  ...                  0.466667                      0.5
2  96   2  ...                       0.6                 0.538462
3  96   2  ...                       0.3                 0.538462
4  96   2  ...                  0.571429                 0.545455

[5 rows x 16 columns],   sub ses  ... prob_sameplanet_earthsame prob_sameplanet_earthdif
0  17   2  ...                      0.52                 0.458333
1  17   2  ...                  0.538462                 0.583333
2  17   2  ...                  0.461538                      0.5
3  17   2  ...                  0.615385                 0.333333
4  17   2  ...                       0.5                 0.384615

[5 rows x 16 columns]]), ('bids_dir', '/Users/azp271/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat'), ('function_str', "def updateDatabase_save(Space_summary_dat, Space_group_trialdat, overwrite_flag, bids_dir):\n    import pandas as pd\n    import numpy as np\n    from pathlib import Path\n    from nipype.interfaces.base import Bunch\n\n    #derivative data path\n    derivative_data_path = Path(bids_dir).joinpath('derivatives/preprocessed/beh')\n\n    #function to drop rows based on values\n    def filter_rows_by_values(df, sub_values, sesnum):\n        #filter based on sub and ses\n        return df[(df['sub'].isin(sub_values) == False) & (df['ses'] == sesnum)]\n\n    #### Summary Data ####\n    #get a Bunch object if more than 1 participant \n    if isinstance(Space_summary_dat, Bunch):        \n        #get output data from node\n        Space_summary_datlist = Space_summary_dat.summarySpace_dat\n\n        #combine datasets \n        Space_summary_dat = pd.concat(Space_summary_datlist)\n\n    #if only 1 participant/dataset then it is a list    \n    elif isinstance(Space_summary_dat, list):\n        if len(Space_summary_dat) == 1:\n            Space_summary_dat = Space_summary_dat[0]\n        else:\n            Space_summary_dat = pd.concat(Space_summary_dat)\n\n    #if a pandas dataframe\n    if isinstance(Space_summary_dat, pd.DataFrame):\n\n        #get column names\n        columnnames = Space_summary_dat.columns\n\n        #get session subsets\n        db_sessions = Space_summary_dat.ses.unique()\n\n        if len(db_sessions) > 1:\n            Space_sum_ses1_dat = Space_summary_dat.groupby('ses').get_group(1)\n            Space_sum_ses2_dat = Space_summary_dat.groupby('ses').get_group(2)\n\n            #make wide data set \n            Space_sum_ses1_wide = Space_sum_ses1_dat.pivot(columns='block', index='sub', values=columnnames[3:16])\n            Space_sum_ses1_wide.columns = ['_'.join(col) for col in Space_sum_ses1_wide.columns.reorder_levels(order=[1, 0])]\n\n            Space_sum_ses2_wide = Space_sum_ses2_dat.pivot(columns='block', index='sub', values=columnnames[3:16])\n            Space_sum_ses2_wide.columns = ['_'.join(col) for col in Space_sum_ses2_wide.columns.reorder_levels(order=[1, 0])]\n\n            #make the sub index into a dataset column\n            Space_sum_ses1_wide = Space_sum_ses1_wide.reset_index(level = 0)\n            Space_sum_ses2_wide = Space_sum_ses2_wide.reset_index(level = 0)\n\n            #add session\n            Space_sum_ses1_wide.insert(1, 'ses', 1)\n            Space_sum_ses2_wide.insert(1, 'ses', 2)\n\n            #concatonate databases\n            Space_summary_wide = pd.concat([Space_sum_ses1_wide,Space_sum_ses2_wide],ignore_index=True)\n\n        else:\n            #make wide data set \n            Space_summary_wide = Space_summary_dat.pivot(columns='block', index='sub', values=columnnames[3:16])        \n            Space_summary_wide.columns = ['_'.join(col) for col in Space_summary_wide.columns.reorder_levels(order=[1, 0])]\n\n            #make the sub index into a dataset column\n            Space_summary_wide = Space_summary_wide.reset_index(level = 0)\n\n            #add session\n            Space_summary_wide.insert(1, 'ses', db_sessions[0])\n\n        #re-order columns\n        columnnames_reorder = ['sub', 'ses', 'all_earth_rt_mean', 'all_earth_rt_median', 'all_earth_n_miss',\n                    'all_earth_p_miss', 'all_planet_rt_mean', 'all_planet_rt_median', 'all_planet_n_miss',\n                    'all_planet_p_miss', 'all_reward_rate', 'all_avg_reward', 'all_reward_rate_corrected', \n                    'all_prob_sameplanet_earthsame', 'all_prob_sameplanet_earthdif',\n                    'b1_earth_rt_mean', 'b1_earth_rt_median', 'b1_earth_n_miss', 'b1_earth_p_miss',\n                    'b1_planet_rt_mean', 'b1_planet_rt_median', 'b1_planet_n_miss', 'b1_planet_p_miss',\n                    'b1_reward_rate', 'b1_avg_reward', 'b1_reward_rate_corrected',\n                    'b1_prob_sameplanet_earthsame','b1_prob_sameplanet_earthdif',\n                    'b2_earth_rt_mean', 'b2_earth_rt_median', 'b2_earth_n_miss', 'b2_earth_p_miss',\n                    'b2_planet_rt_mean', 'b2_planet_rt_median', 'b2_planet_n_miss', 'b2_planet_p_miss',\n                    'b2_reward_rate', 'b2_avg_reward', 'b2_reward_rate_corrected',\n                    'b2_prob_sameplanet_earthsame', 'b2_prob_sameplanet_earthdif',\n                    'b3_earth_rt_mean', 'b3_earth_rt_median', 'b3_earth_n_miss', 'b3_earth_p_miss',\n                    'b3_planet_rt_mean','b3_planet_rt_median', 'b3_planet_n_miss', 'b3_planet_p_miss',\n                    'b3_reward_rate', 'b3_avg_reward', 'b3_reward_rate_corrected', \n                    'b3_prob_sameplanet_earthsame','b3_prob_sameplanet_earthdif',\n                    'b4_earth_rt_mean', 'b4_earth_rt_median', 'b4_earth_n_miss', 'b4_earth_p_miss', \n                    'b4_planet_rt_mean', 'b4_planet_rt_median', 'b4_planet_n_miss', 'b4_planet_p_miss',  \n                    'b4_reward_rate', 'b4_avg_reward', 'b4_reward_rate_corrected', \n                    'b4_prob_sameplanet_earthsame', 'b4_prob_sameplanet_earthdif']\n\n        Space_summary_wide = Space_summary_wide.reindex(columns=columnnames_reorder)\n\n        #get blocks subset\n        Space_summary_blocks = Space_summary_dat[Space_summary_dat.block.isin(['b1', 'b2', 'b3', 'b4'])] \n\n        #load databases\n        Space_database_wide = pd.read_csv(str(Path(derivative_data_path).joinpath('task-space_summary.tsv')), sep = '\\t') \n        Space_database_blocks = pd.read_csv(str(Path(derivative_data_path).joinpath('task-space_summary_long.tsv')), sep = '\\t')\n\n        #if overwriting participants\n        if overwrite_flag == True:\n            #filter out/remove exisiting subs to overwrit~\n            if len(db_sessions) > 1:\n                #get list of subs by ses to filter in wide and long data\n                wide_sub_list = Space_summary_wide.groupby('ses')['sub'].unique()\n                long_sub_list = Space_summary_blocks.groupby('ses')['sub'].unique()\n\n                Space_database_ses1 = filter_rows_by_values(Space_database_wide, wide_sub_list[0], 1)\n                Space_database_ses2 = filter_rows_by_values(Space_database_wide, wide_sub_list[1], 2)\n\n                Space_database_ses1_long = filter_rows_by_values(Space_database_blocks, long_sub_list[0], 1)\n                Space_database_ses2_long = filter_rows_by_values(Space_database_blocks, long_sub_list[1], 2)\n\n                #concatonate databases\n                Space_database_wide = pd.concat([Space_database_ses1, Space_database_ses2],ignore_index=True)\n                Space_database_blocks = pd.concat([Space_database_ses1_long, Space_database_ses2_long],ignore_index=True)\n\n            else:\n                wide_sub_list = list(Space_summary_wide['sub'].unique())\n                long_sub_list = list(Space_summary_blocks['sub'].unique())\n\n                #filter by ses and sub\n                Space_database_ses = filter_rows_by_values(Space_database_wide, wide_sub_list, db_sessions[0])\n                Space_database_long_ses = filter_rows_by_values(Space_database_blocks, long_sub_list, db_sessions[0])\n\n                #concatonate with other session in full database\n                Space_database_wide = pd.concat([Space_database_wide[Space_database_wide['ses'] != db_sessions[0]], Space_database_ses],ignore_index=True)\n                Space_database_blocks = pd.concat([Space_database_blocks[Space_database_blocks['ses'] != db_sessions[0]], Space_database_long_ses],ignore_index=True)\n\n\n        #add newly processed data\n        Space_database_wide = Space_database_wide.append(Space_summary_wide)\n        Space_database_blocks = Space_database_blocks.append(Space_summary_blocks)\n\n        #sort to ensure in sub order\n        Space_database_wide = Space_database_wide.sort_values(by = ['ses', 'sub'])\n        Space_database_blocks = Space_database_blocks.sort_values(by = ['ses', 'sub', 'block'])\n\n        #round to 3 decimal points\n        Space_database_wide = Space_database_wide.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)\n        Space_database_blocks = Space_database_blocks.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)\n\n        #write databases\n        Space_database_wide.to_csv(str(Path(derivative_data_path).joinpath('task-space_summary.tsv')), sep = '\\t', encoding='utf-8-sig', index = False) \n        Space_database_blocks.to_csv(str(Path(derivative_data_path).joinpath('task-space_summary_long.tsv')), sep = '\\t', encoding='utf-8-sig', index = False)\n\n    else:\n        print('No raw data files that need to be processed')\n        Space_database_wide = np.nan\n        Space_database_blocks = np.nan\n\n    #### Group trial data ####\n\n    #get a Bunch object if more than 1 participant \n    if isinstance(Space_group_trialdat, Bunch):        \n        #get output data from node\n        Space_group_trialdatlist = Space_group_trialdat.group_trialdat\n\n        #combine datasets \n        Space_groupdat = pd.concat(Space_group_trialdatlist)\n\n    #if only 1 participant/dataset then it is a list    \n    elif isinstance(Space_group_trialdat, list):\n        if len(Space_group_trialdat) == 1:\n            Space_groupdat = Space_group_trialdat[0]\n        else:\n            Space_groupdat = pd.concat(Space_group_trialdat)\n\n    #if a pandas dataframe\n    if isinstance(Space_groupdat, pd.DataFrame):\n\n        #get session subsets\n        db_group_sessions = Space_groupdat.ses.unique()\n\n        #load databases\n        Space_groupdat_database = pd.read_csv(str(Path(derivative_data_path).joinpath('task-space_groupdata.tsv')), sep = '\\t') \n\n        #if overwriting participants\n        if overwrite_flag == True:\n            #filter out/remove exisiting subs to overwrit~\n            if len(db_group_sessions) > 1:\n                #get list of subs by ses to filter in wide and long data\n                dat_sub_list = Space_groupdat.groupby('ses')['sub'].unique()\n\n                Space_groupdat_ses1 = filter_rows_by_values(Space_groupdat_database, dat_sub_list[0], 1)\n                Space_groupdat_ses2 = filter_rows_by_values(Space_groupdat_database, dat_sub_list[1], 2)\n\n                #concatonate databases\n                Space_groupdat_database = pd.concat([Space_groupdat_ses1, Space_groupdat_ses2],ignore_index=True)\n\n            else:\n                dat_sub_list = list(Space_groupdat['sub'].unique())\n\n                #filter by ses and sub\n                Space_groupdat_ses = filter_rows_by_values(Space_groupdat_database, dat_sub_list, db_group_sessions[0])\n\n                #concatonate with other session in full database\n                Space_groupdat_database = pd.concat([Space_groupdat_database[Space_groupdat_database['ses'] != db_group_sessions[0]], Space_groupdat_ses],ignore_index=True)\n\n        #add newly processed data\n        Space_groupdat_database = Space_groupdat_database.append(Space_groupdat)\n\n        #sort to ensure in sub order\n        Space_groupdat_database = Space_groupdat_database.sort_values(by = ['sub', 'ses'])\n\n        #round to 3 decimal points\n        Space_groupdat_database = Space_groupdat_database.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)\n\n        #write databases\n        Space_groupdat_database.to_csv(str(Path(derivative_data_path).joinpath('task-space_groupdata.tsv')), sep = '\\t', encoding='utf-8-sig', index = False) \n\n    else:\n        print('No raw trial data files that need to be processed')\n        Space_groupdat = np.nan\n\n    return Space_database_wide, Space_database_blocks, Space_groupdat\n"), ('overwrite_flag', True)]