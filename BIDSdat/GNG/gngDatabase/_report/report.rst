Node: gngDatabase (utility)
===========================


 Hierarchy : GNG.gngDatabase
 Exec ID : gngDatabase


Original Inputs
---------------


* GNG_summary_dat : [  sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  31   all  150    50  175  0.875     146        4         29       21  0.973333  0.026667       0.58     0.42   483.438356     434.52381       476.5        341.0
1  31    b1   30    10   37  0.925      30        0          7        3       1.0       0.0        0.7      0.3   507.233333    312.666667       498.5        300.0
2  31    b2   30    10    0    0.0      28        2          3        7  0.933333  0.066667        0.3      0.7   488.964286    498.857143       506.5        333.0
3  31    b3   30    10    0    0.0      28        2          6        4  0.933333  0.066667        0.6      0.4   442.678571        374.25       435.5        327.0
4  31    b4   30    10    0    0.0      30        0          5        5       1.0       0.0        0.5      0.5   518.033333         476.6       504.5        382.0
5  31    b5   30    10    0    0.0      30        0          8        2       1.0       0.0        0.8      0.2   457.933333         407.5       449.0        407.5,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  33   all  150    50  178   0.89     146        4         32       18  0.973333  0.026667       0.64     0.36   649.671233         481.5       646.5        493.5
1  33    b1   30    10   35  0.875      28        2          7        3  0.933333  0.066667        0.7      0.3   636.178571    513.333333       646.5        518.0
2  33    b2   30    10    0    0.0      30        0          9        1       1.0       0.0        0.9      0.1   686.333333         454.0       676.0        454.0
3  33    b3   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   648.724138    545.333333       606.0        538.0
4  33    b4   30    10    0    0.0      30        0          4        6       1.0       0.0        0.4      0.6   672.366667    440.833333       660.0        425.0
5  33    b5   30    10    0    0.0      29        1          5        5  0.966667  0.033333        0.5      0.5   602.241379         478.4       577.0        542.0,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  34   all  150    50  179  0.895     146        4         33       17  0.973333  0.026667       0.66     0.34   538.780822    462.941176       530.0        457.0
1  34    b1   30    10   34   0.85      29        1          5        5  0.966667  0.033333        0.5      0.5   522.862069         428.0       509.0        414.0
2  34    b2   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   558.551724    545.666667       549.0        497.0
3  34    b3   30    10    0    0.0      30        0          7        3       1.0       0.0        0.7      0.3   528.433333    381.333333       498.0        370.0
4  34    b4   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   561.034483    481.666667       549.0        491.0
5  34    b5   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3    523.37931    501.333333       513.0        520.0,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  35   all  150    50  179  0.895     143        7         36       14  0.953333  0.046667       0.72     0.28   606.265734    514.642857       581.0        511.5
1  35    b1   30    10   38   0.95      29        1          9        1  0.966667  0.033333        0.9      0.1   578.758621         470.0       580.0        470.0
2  35    b2   30    10    0    0.0      27        3          6        4       0.9       0.1        0.6      0.4   598.777778         511.0       589.0        518.0
3  35    b3   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   599.034483    555.666667       581.0        510.0
4  35    b4   30    10    0    0.0      28        2          7        3  0.933333  0.066667        0.7      0.3   643.321429    540.666667       630.0        519.0
5  35    b5   30    10    0    0.0      30        0          7        3       1.0       0.0        0.7      0.3        612.0    467.333333       558.5        493.0,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  36   all  150    50  175  0.875     147        3         28       22      0.98      0.02       0.56     0.44    447.55102    418.863636       434.0        392.0
1  36    b1   30    10   37  0.925      30        0          7        3       1.0       0.0        0.7      0.3        441.6    335.333333       430.5        317.0
2  36    b2   30    10    0    0.0      30        0          6        4       1.0       0.0        0.6      0.4   459.066667        340.25       420.0        351.0
3  36    b3   30    10    0    0.0      30        0          6        4       1.0       0.0        0.6      0.4   463.133333         486.0       443.5        490.5
4  36    b4   30    10    0    0.0      29        1          5        5  0.966667  0.033333        0.5      0.5   432.517241         351.4       427.0        371.0
5  36    b5   30    10    0    0.0      28        2          4        6  0.933333  0.066667        0.4      0.6   440.464286         524.5       432.0        478.0]
* bids_dir : /Users/baf44/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat
* function_str : def updateDatabase_save(GNG_summary_dat, overwrite_flag, bids_dir):
    import pandas as pd
    import numpy as np
    from pathlib import Path
    from nipype.interfaces.base import Bunch

    #get a Bunch object if more than 1 participant 
    if isinstance(GNG_summary_dat, Bunch):        
        #get output data from node
        GNG_summary_datlist = GNG_summary_dat.summaryGNG_dat

        #combine datasets 
        GNG_summary_dat = pd.concat(GNG_summary_datlist)

    #if only 1 participant/dataset then it is a list    
    elif isinstance(GNG_summary_dat, list):
        if len(GNG_summary_dat) == 1:
            GNG_summary_dat = GNG_summary_dat[0]
        else:
            GNG_summary_dat = pd.concat(GNG_summary_dat)

    #if a pandas dataframe
    if isinstance(GNG_summary_dat, pd.DataFrame):

        #get column names
        columnnames = GNG_summary_dat.columns

        #get condition subset (overall and each block)
        #GNG_summary_dat['block'] = GNG_summary_dat['block'].astype(str)
        GNG_summary_conditions = GNG_summary_dat[GNG_summary_dat.block.isin(['all', 'b1', 'b2', 'b3', 'b4', 'b5'])]

        #make wide data set (for every variable, a column for overall and each block)
        GNG_summary_wide = GNG_summary_conditions.pivot(columns='block', index='sub', values=columnnames[2:])        
        GNG_summary_wide.columns = ['_'.join(col) for col in GNG_summary_wide.columns.reorder_levels(order=[1, 0])]

        #make the sub index into a dataset column
        GNG_summary_wide = GNG_summary_wide.reset_index(level = 0)

        #re-order columns
        columnnames_reorder = ['sub', 'all_nGo', 'all_nNoGo', 'all_nAcc', 'all_pAcc', 'all_nGo_Hit', 'all_nGo_Miss', 'all_nNoGo_Corr', 
                              'all_nNoGo_FA', 'all_pGo_Hit', 'all_pGo_Miss', 'all_pNoGo_Corr', 'all_pNoGo_FA', 'all_RTmeanGo_Hit', 
                              'all_RTmeanNoGo_FA', 'all_RTmedGo_Hit', 'all_RTmedNoGo_FA',

                              'b1_nGo', 'b1_nNoGo', 'b1_nAcc', 'b1_pAcc', 'b1_nGo_Hit', 'b1_nGo_Miss', 'b1_nNoGo_Corr', 
                              'b1_nNoGo_FA', 'b1_pGo_Hit', 'b1_pGo_Miss', 'b1_pNoGo_Corr', 'b1_pNoGo_FA', 'b1_RTmeanGo_Hit', 
                              'b1_RTmeanNoGo_FA', 'b1_RTmedGo_Hit', 'b1_RTmedNoGo_FA',

                              'b2_nGo', 'b2_nNoGo', 'b2_nAcc', 'b2_pAcc', 'b2_nGo_Hit', 'b2_nGo_Miss', 'b2_nNoGo_Corr', 
                              'b2_nNoGo_FA', 'b2_pGo_Hit', 'b2_pGo_Miss', 'b2_pNoGo_Corr', 'b2_pNoGo_FA', 'b2_RTmeanGo_Hit', 
                              'b2_RTmeanNoGo_FA', 'b2_RTmedGo_Hit', 'b2_RTmedNoGo_FA',

                              'b3_nGo', 'b3_nNoGo', 'b3_nAcc', 'b3_pAcc', 'b3_nGo_Hit', 'b3_nGo_Miss', 'b3_nNoGo_Corr', 
                              'b3_nNoGo_FA', 'b3_pGo_Hit', 'b3_pGo_Miss', 'b3_pNoGo_Corr', 'b3_pNoGo_FA', 'b3_RTmeanGo_Hit', 
                              'b3_RTmeanNoGo_FA', 'b3_RTmedGo_Hit', 'b3_RTmedNoGo_FA',

                              'b4_nGo', 'b4_nNoGo', 'b4_nAcc', 'b4_pAcc', 'b4_nGo_Hit', 'b4_nGo_Miss', 'b4_nNoGo_Corr', 
                              'b4_nNoGo_FA', 'b4_pGo_Hit', 'b4_pGo_Miss', 'b4_pNoGo_Corr', 'b4_pNoGo_FA', 'b4_RTmeanGo_Hit', 
                              'b4_RTmeanNoGo_FA', 'b4_RTmedGo_Hit', 'b4_RTmedNoGo_FA',

                              'b5_nGo', 'b5_nNoGo', 'b5_nAcc', 'b5_pAcc', 'b5_nGo_Hit', 'b5_nGo_Miss', 'b5_nNoGo_Corr', 
                              'b5_nNoGo_FA', 'b5_pGo_Hit', 'b5_pGo_Miss', 'b5_pNoGo_Corr', 'b5_pNoGo_FA', 'b5_RTmeanGo_Hit', 
                              'b5_RTmeanNoGo_FA', 'b5_RTmedGo_Hit', 'b5_RTmedNoGo_FA']

        GNG_summary_wide = GNG_summary_wide.reindex(columns=columnnames_reorder)

        #get indiviudal blocks subset
        GNG_summary_blocks = GNG_summary_dat[GNG_summary_dat.block.isin(['b1', 'b2', 'b3', 'b4', 'b5'])] 

        ## load databases
        #derivative data path
        derivative_data_path = Path(bids_dir).joinpath('derivatives/preprocessed/beh')

        #load databases
        GNG_database = pd.read_csv(str(Path(derivative_data_path).joinpath('task-gng_summary.tsv')), sep = '\t') 
        GNG_database_long = pd.read_csv(str(Path(derivative_data_path).joinpath('task-gng_summary_long.tsv')), sep = '\t')

        #if overwriting participants
        if overwrite_flag == True:
            #function to drop rows based on values
            def filter_rows_by_values(df, col, values):
                return df[df[col].isin(values) == False]

            #get list of subs to filter in wide and long data
            wide_sub_list = list(GNG_summary_wide['sub'].unique())
            long_sub_list = list(GNG_summary_blocks['sub'].unique())

            #filter out/remove exisiting subs to overwrite
            GNG_database = filter_rows_by_values(GNG_database, 'sub', wide_sub_list)
            GNG_database_long = filter_rows_by_values(GNG_database_long, 'sub', long_sub_list)

        #add newly processed data
        GNG_database = GNG_database.append(GNG_summary_wide)
        GNG_database_long = GNG_database_long.append(GNG_summary_blocks)

        #round to 3 decimal points
        GNG_database = GNG_database.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)
        GNG_database_long = GNG_database_long.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)

        #write databases
        GNG_database.to_csv(str(Path(derivative_data_path).joinpath('task-gng_summary.tsv')), sep = '\t', encoding='utf-8-sig', index = False) 
        GNG_database_long.to_csv(str(Path(derivative_data_path).joinpath('task-gng_summary_long.tsv')), sep = '\t', encoding='utf-8-sig', index = False)

    else:
        print('No raw data files that need to be processed')
        GNG_database = np.nan
        GNG_database_long = np.nan

    return GNG_database, GNG_database_long

* overwrite_flag : False


Execution Inputs
----------------


* GNG_summary_dat : [  sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  31   all  150    50  175  0.875     146        4         29       21  0.973333  0.026667       0.58     0.42   483.438356     434.52381       476.5        341.0
1  31    b1   30    10   37  0.925      30        0          7        3       1.0       0.0        0.7      0.3   507.233333    312.666667       498.5        300.0
2  31    b2   30    10    0    0.0      28        2          3        7  0.933333  0.066667        0.3      0.7   488.964286    498.857143       506.5        333.0
3  31    b3   30    10    0    0.0      28        2          6        4  0.933333  0.066667        0.6      0.4   442.678571        374.25       435.5        327.0
4  31    b4   30    10    0    0.0      30        0          5        5       1.0       0.0        0.5      0.5   518.033333         476.6       504.5        382.0
5  31    b5   30    10    0    0.0      30        0          8        2       1.0       0.0        0.8      0.2   457.933333         407.5       449.0        407.5,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  33   all  150    50  178   0.89     146        4         32       18  0.973333  0.026667       0.64     0.36   649.671233         481.5       646.5        493.5
1  33    b1   30    10   35  0.875      28        2          7        3  0.933333  0.066667        0.7      0.3   636.178571    513.333333       646.5        518.0
2  33    b2   30    10    0    0.0      30        0          9        1       1.0       0.0        0.9      0.1   686.333333         454.0       676.0        454.0
3  33    b3   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   648.724138    545.333333       606.0        538.0
4  33    b4   30    10    0    0.0      30        0          4        6       1.0       0.0        0.4      0.6   672.366667    440.833333       660.0        425.0
5  33    b5   30    10    0    0.0      29        1          5        5  0.966667  0.033333        0.5      0.5   602.241379         478.4       577.0        542.0,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  34   all  150    50  179  0.895     146        4         33       17  0.973333  0.026667       0.66     0.34   538.780822    462.941176       530.0        457.0
1  34    b1   30    10   34   0.85      29        1          5        5  0.966667  0.033333        0.5      0.5   522.862069         428.0       509.0        414.0
2  34    b2   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   558.551724    545.666667       549.0        497.0
3  34    b3   30    10    0    0.0      30        0          7        3       1.0       0.0        0.7      0.3   528.433333    381.333333       498.0        370.0
4  34    b4   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   561.034483    481.666667       549.0        491.0
5  34    b5   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3    523.37931    501.333333       513.0        520.0,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  35   all  150    50  179  0.895     143        7         36       14  0.953333  0.046667       0.72     0.28   606.265734    514.642857       581.0        511.5
1  35    b1   30    10   38   0.95      29        1          9        1  0.966667  0.033333        0.9      0.1   578.758621         470.0       580.0        470.0
2  35    b2   30    10    0    0.0      27        3          6        4       0.9       0.1        0.6      0.4   598.777778         511.0       589.0        518.0
3  35    b3   30    10    0    0.0      29        1          7        3  0.966667  0.033333        0.7      0.3   599.034483    555.666667       581.0        510.0
4  35    b4   30    10    0    0.0      28        2          7        3  0.933333  0.066667        0.7      0.3   643.321429    540.666667       630.0        519.0
5  35    b5   30    10    0    0.0      30        0          7        3       1.0       0.0        0.7      0.3        612.0    467.333333       558.5        493.0,   sub block  nGo nNoGo nAcc   pAcc nGo_Hit nGo_Miss nNoGo_Corr nNoGo_FA   pGo_Hit  pGo_Miss pNoGo_Corr pNoGo_FA RTmeanGo_Hit RTmeanNoGo_FA RTmedGo_Hit RTmedNoGo_FA
0  36   all  150    50  175  0.875     147        3         28       22      0.98      0.02       0.56     0.44    447.55102    418.863636       434.0        392.0
1  36    b1   30    10   37  0.925      30        0          7        3       1.0       0.0        0.7      0.3        441.6    335.333333       430.5        317.0
2  36    b2   30    10    0    0.0      30        0          6        4       1.0       0.0        0.6      0.4   459.066667        340.25       420.0        351.0
3  36    b3   30    10    0    0.0      30        0          6        4       1.0       0.0        0.6      0.4   463.133333         486.0       443.5        490.5
4  36    b4   30    10    0    0.0      29        1          5        5  0.966667  0.033333        0.5      0.5   432.517241         351.4       427.0        371.0
5  36    b5   30    10    0    0.0      28        2          4        6  0.933333  0.066667        0.4      0.6   440.464286         524.5       432.0        478.0]
* bids_dir : /Users/baf44/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat
* function_str : def updateDatabase_save(GNG_summary_dat, overwrite_flag, bids_dir):
    import pandas as pd
    import numpy as np
    from pathlib import Path
    from nipype.interfaces.base import Bunch

    #get a Bunch object if more than 1 participant 
    if isinstance(GNG_summary_dat, Bunch):        
        #get output data from node
        GNG_summary_datlist = GNG_summary_dat.summaryGNG_dat

        #combine datasets 
        GNG_summary_dat = pd.concat(GNG_summary_datlist)

    #if only 1 participant/dataset then it is a list    
    elif isinstance(GNG_summary_dat, list):
        if len(GNG_summary_dat) == 1:
            GNG_summary_dat = GNG_summary_dat[0]
        else:
            GNG_summary_dat = pd.concat(GNG_summary_dat)

    #if a pandas dataframe
    if isinstance(GNG_summary_dat, pd.DataFrame):

        #get column names
        columnnames = GNG_summary_dat.columns

        #get condition subset (overall and each block)
        #GNG_summary_dat['block'] = GNG_summary_dat['block'].astype(str)
        GNG_summary_conditions = GNG_summary_dat[GNG_summary_dat.block.isin(['all', 'b1', 'b2', 'b3', 'b4', 'b5'])]

        #make wide data set (for every variable, a column for overall and each block)
        GNG_summary_wide = GNG_summary_conditions.pivot(columns='block', index='sub', values=columnnames[2:])        
        GNG_summary_wide.columns = ['_'.join(col) for col in GNG_summary_wide.columns.reorder_levels(order=[1, 0])]

        #make the sub index into a dataset column
        GNG_summary_wide = GNG_summary_wide.reset_index(level = 0)

        #re-order columns
        columnnames_reorder = ['sub', 'all_nGo', 'all_nNoGo', 'all_nAcc', 'all_pAcc', 'all_nGo_Hit', 'all_nGo_Miss', 'all_nNoGo_Corr', 
                              'all_nNoGo_FA', 'all_pGo_Hit', 'all_pGo_Miss', 'all_pNoGo_Corr', 'all_pNoGo_FA', 'all_RTmeanGo_Hit', 
                              'all_RTmeanNoGo_FA', 'all_RTmedGo_Hit', 'all_RTmedNoGo_FA',

                              'b1_nGo', 'b1_nNoGo', 'b1_nAcc', 'b1_pAcc', 'b1_nGo_Hit', 'b1_nGo_Miss', 'b1_nNoGo_Corr', 
                              'b1_nNoGo_FA', 'b1_pGo_Hit', 'b1_pGo_Miss', 'b1_pNoGo_Corr', 'b1_pNoGo_FA', 'b1_RTmeanGo_Hit', 
                              'b1_RTmeanNoGo_FA', 'b1_RTmedGo_Hit', 'b1_RTmedNoGo_FA',

                              'b2_nGo', 'b2_nNoGo', 'b2_nAcc', 'b2_pAcc', 'b2_nGo_Hit', 'b2_nGo_Miss', 'b2_nNoGo_Corr', 
                              'b2_nNoGo_FA', 'b2_pGo_Hit', 'b2_pGo_Miss', 'b2_pNoGo_Corr', 'b2_pNoGo_FA', 'b2_RTmeanGo_Hit', 
                              'b2_RTmeanNoGo_FA', 'b2_RTmedGo_Hit', 'b2_RTmedNoGo_FA',

                              'b3_nGo', 'b3_nNoGo', 'b3_nAcc', 'b3_pAcc', 'b3_nGo_Hit', 'b3_nGo_Miss', 'b3_nNoGo_Corr', 
                              'b3_nNoGo_FA', 'b3_pGo_Hit', 'b3_pGo_Miss', 'b3_pNoGo_Corr', 'b3_pNoGo_FA', 'b3_RTmeanGo_Hit', 
                              'b3_RTmeanNoGo_FA', 'b3_RTmedGo_Hit', 'b3_RTmedNoGo_FA',

                              'b4_nGo', 'b4_nNoGo', 'b4_nAcc', 'b4_pAcc', 'b4_nGo_Hit', 'b4_nGo_Miss', 'b4_nNoGo_Corr', 
                              'b4_nNoGo_FA', 'b4_pGo_Hit', 'b4_pGo_Miss', 'b4_pNoGo_Corr', 'b4_pNoGo_FA', 'b4_RTmeanGo_Hit', 
                              'b4_RTmeanNoGo_FA', 'b4_RTmedGo_Hit', 'b4_RTmedNoGo_FA',

                              'b5_nGo', 'b5_nNoGo', 'b5_nAcc', 'b5_pAcc', 'b5_nGo_Hit', 'b5_nGo_Miss', 'b5_nNoGo_Corr', 
                              'b5_nNoGo_FA', 'b5_pGo_Hit', 'b5_pGo_Miss', 'b5_pNoGo_Corr', 'b5_pNoGo_FA', 'b5_RTmeanGo_Hit', 
                              'b5_RTmeanNoGo_FA', 'b5_RTmedGo_Hit', 'b5_RTmedNoGo_FA']

        GNG_summary_wide = GNG_summary_wide.reindex(columns=columnnames_reorder)

        #get indiviudal blocks subset
        GNG_summary_blocks = GNG_summary_dat[GNG_summary_dat.block.isin(['b1', 'b2', 'b3', 'b4', 'b5'])] 

        ## load databases
        #derivative data path
        derivative_data_path = Path(bids_dir).joinpath('derivatives/preprocessed/beh')

        #load databases
        GNG_database = pd.read_csv(str(Path(derivative_data_path).joinpath('task-gng_summary.tsv')), sep = '\t') 
        GNG_database_long = pd.read_csv(str(Path(derivative_data_path).joinpath('task-gng_summary_long.tsv')), sep = '\t')

        #if overwriting participants
        if overwrite_flag == True:
            #function to drop rows based on values
            def filter_rows_by_values(df, col, values):
                return df[df[col].isin(values) == False]

            #get list of subs to filter in wide and long data
            wide_sub_list = list(GNG_summary_wide['sub'].unique())
            long_sub_list = list(GNG_summary_blocks['sub'].unique())

            #filter out/remove exisiting subs to overwrite
            GNG_database = filter_rows_by_values(GNG_database, 'sub', wide_sub_list)
            GNG_database_long = filter_rows_by_values(GNG_database_long, 'sub', long_sub_list)

        #add newly processed data
        GNG_database = GNG_database.append(GNG_summary_wide)
        GNG_database_long = GNG_database_long.append(GNG_summary_blocks)

        #round to 3 decimal points
        GNG_database = GNG_database.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)
        GNG_database_long = GNG_database_long.applymap(lambda x: round(x, 3) if isinstance(x, (int, float)) else x)

        #write databases
        GNG_database.to_csv(str(Path(derivative_data_path).joinpath('task-gng_summary.tsv')), sep = '\t', encoding='utf-8-sig', index = False) 
        GNG_database_long.to_csv(str(Path(derivative_data_path).joinpath('task-gng_summary_long.tsv')), sep = '\t', encoding='utf-8-sig', index = False)

    else:
        print('No raw data files that need to be processed')
        GNG_database = np.nan
        GNG_database_long = np.nan

    return GNG_database, GNG_database_long

* overwrite_flag : False


Execution Outputs
-----------------


* GNG_database :     sub  all_nGo  all_nNoGo  all_nAcc  all_pAcc  all_nGo_Hit  ...  b5_pNoGo_Corr  b5_pNoGo_FA  b5_RTmeanGo_Hit  b5_RTmeanNoGo_FA  b5_RTmedGo_Hit  b5_RTmedNoGo_FA
0     7      150         50       180     0.900          150  ...            0.7          0.3          525.467           428.333           528.5            447.0
1     3      150         50       183     0.915          140  ...            0.6          0.4          574.367           409.250           564.5            456.0
2     4      150         50       171     0.855          143  ...            0.5          0.5          559.172           461.000           501.0            461.0
3     5      150         50       187     0.935          150  ...            0.6          0.4          538.633           425.500           554.5            405.5
4     1      150         50       180     0.900          148  ...            0.6          0.4          472.733           397.500           473.0            382.0
5     2      150         50       189     0.945          149  ...            0.7          0.3          525.833           405.667           541.5            399.0
6     4      150         50       171     0.855          143  ...            0.5          0.5          559.172           461.000           501.0            461.0
7     6      150         50       182     0.910          147  ...            0.7          0.3          622.690           432.667           601.0            469.0
8     9      150         50       157     0.785          138  ...            0.3          0.7          386.538           371.714           381.5            394.0
9    11      150         50       190     0.950          148  ...            0.9          0.1          476.345           315.000           482.0            315.0
10   17      150         50       173     0.865          148  ...            0.5          0.5          550.500           554.800           541.0            463.0
11   18      150         50       184     0.920          150  ...            0.7          0.3          507.633           510.667           525.5            488.0
12   19      150         50       176     0.880          145  ...            0.4          0.6          557.900           412.500           511.0            397.0
13   20      150         50       174     0.870          143  ...            0.7          0.3          643.240           421.000           627.0            411.0
14   21      150         50       185     0.925          148  ...            0.8          0.2          594.724           381.000           588.0            381.0
15   22      150         50       180     0.900          144  ...            0.6          0.4          618.857           507.500           591.0            510.5
16   23      150         50       171     0.855          138  ...            0.8          0.2          528.733           552.000           542.0            552.0
17   26      150         50       191     0.955          150  ...            0.7          0.3          552.600           433.667           554.5            446.0
18   28      150         50       177     0.885          147  ...            0.4          0.6          462.103           435.333           443.0            391.5
19   51      150         50         2     0.010            2  ...            0.0          1.0          468.000           610.900           468.0            634.5
20   30      150         50       183     0.915          144  ...            0.8          0.2          588.167           456.000           587.5            456.0
0    31      150         50       175     0.875          146  ...            0.8          0.2          457.933           407.500           449.0            407.5
1    33      150         50       178     0.890          146  ...            0.5          0.5          602.241           478.400           577.0            542.0
2    34      150         50       179     0.895          146  ...            0.7          0.3          523.379           501.333           513.0            520.0
3    35      150         50       179     0.895          143  ...            0.7          0.3          612.000           467.333           558.5            493.0
4    36      150         50       175     0.875          147  ...            0.4          0.6          440.464           524.500           432.0            478.0

[26 rows x 97 columns]
* GNG_database_wide :     sub block  nGo  nNoGo  nAcc   pAcc  nGo_Hit  nGo_Miss  ...  pGo_Hit  pGo_Miss  pNoGo_Corr  pNoGo_FA  RTmeanGo_Hit  RTmeanNoGo_FA  RTmedGo_Hit  RTmedNoGo_FA
0     7    b1   30     10    34  0.850       30         0  ...    1.000     0.000         0.4       0.6       492.533        412.500        453.0         397.5
1     7    b2   30     10    34  0.850       30         0  ...    1.000     0.000         0.4       0.6       551.300        376.833        529.0         457.0
2     7    b3   30     10    37  0.925       30         0  ...    1.000     0.000         0.7       0.3       551.033        479.000        535.5         465.0
3     7    b4   30     10    38  0.950       30         0  ...    1.000     0.000         0.8       0.2       549.200        422.500        561.5         422.5
4     7    b5   30     10    37  0.925       30         0  ...    1.000     0.000         0.7       0.3       525.467        428.333        528.5         447.0
..  ...   ...  ...    ...   ...    ...      ...       ...  ...      ...       ...         ...       ...           ...            ...          ...           ...
1    36    b1   30     10    37  0.925       30         0  ...    1.000     0.000         0.7       0.3       441.600        335.333        430.5         317.0
2    36    b2   30     10     0  0.000       30         0  ...    1.000     0.000         0.6       0.4       459.067        340.250        420.0         351.0
3    36    b3   30     10     0  0.000       30         0  ...    1.000     0.000         0.6       0.4       463.133        486.000        443.5         490.5
4    36    b4   30     10     0  0.000       29         1  ...    0.967     0.033         0.5       0.5       432.517        351.400        427.0         371.0
5    36    b5   30     10     0  0.000       28         2  ...    0.933     0.067         0.4       0.6       440.464        524.500        432.0         478.0

[130 rows x 18 columns]


Runtime info
------------


* duration : 0.033808
* hostname : H8-NTR-GCH12202
* prev_wd : /Users/baf44/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat
* working_dir : /Users/baf44/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/GNG/gngDatabase


Environment
~~~~~~~~~~~


* CONDA_DEFAULT_ENV : base
* CONDA_EXE : /Users/baf44/opt/anaconda3/bin/conda
* CONDA_PREFIX : /Users/baf44/opt/anaconda3
* CONDA_PROMPT_MODIFIER : (base) 
* CONDA_PYTHON_EXE : /Users/baf44/opt/anaconda3/bin/python
* CONDA_SHLVL : 1
* DISPLAY : /private/tmp/com.apple.launchd.HNyHFHddaJ/org.xquartz:0
* FIX_VERTEX_AREA : 
* FMRI_ANALYSIS_DIR : /Users/baf44/freesurfer/fsfast
* FREESURFER : /Users/baf44/freesurfer
* FREESURFER_HOME : /Users/baf44/freesurfer
* FSFAST_HOME : /Users/baf44/freesurfer/fsfast
* FSF_OUTPUT_FORMAT : nii.gz
* FS_OVERRIDE : 0
* FUNCTIONALS_DIR : /Users/baf44/freesurfer/sessions
* HOME : /Users/baf44
* HOMEBREW_CELLAR : /opt/homebrew/Cellar
* HOMEBREW_PREFIX : /opt/homebrew
* HOMEBREW_REPOSITORY : /opt/homebrew
* HOMEBREW_SHELLENV_PREFIX : /opt/homebrew
* INFOPATH : /opt/homebrew/share/info:
* LANG : en_US.UTF-8
* LOCAL_DIR : /Users/baf44/freesurfer/local
* LOGNAME : baf44
* MANPATH : /opt/homebrew/share/man:
* MINC_BIN_DIR : /Users/baf44/freesurfer/mni/bin
* MINC_LIB_DIR : /Users/baf44/freesurfer/mni/lib
* MNI_DATAPATH : /Users/baf44/freesurfer/mni/data
* MNI_DIR : /Users/baf44/freesurfer/mni
* MNI_PERL5LIB : /Users/baf44/freesurfer/mni/lib/../Library/Perl/Updates/5.12.3
* OLDPWD : /Users/baf44
* OS : Darwin
* PATH : /Users/baf44/opt/anaconda3/bin:/Users/baf44/opt/anaconda3/condabin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/baf44/freesurfer/bin:/Users/baf44/freesurfer/fsfast/bin:/Users/baf44/freesurfer/mni/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/Users/baf44/abin
* PERL5LIB : /Users/baf44/freesurfer/mni/lib/../Library/Perl/Updates/5.12.3
* PWD : /Users/baf44/OneDrive - The Pennsylvania State University/b-childfoodlab_Shared/Active_Studies/RO1_Brain_Mechanisms_IRB_5357/Participant_Data/BIDSdat/code
* SHELL : /bin/bash
* SHLVL : 1
* SSH_AUTH_SOCK : /private/tmp/com.apple.launchd.IGHDFDpBhr/Listeners
* SUBJECTS_DIR : /Users/baf44/freesurfer/subjects
* TERM : xterm-256color
* TERM_PROGRAM : Apple_Terminal
* TERM_PROGRAM_VERSION : 440
* TERM_SESSION_ID : E284AFD2-CB89-4563-819F-34ED4239660B
* TMPDIR : /var/folders/73/mkrc96td4nv8hyspvjhndxt40000gp/T/
* USER : baf44
* XPC_FLAGS : 0x0
* XPC_SERVICE_NAME : 0
* _ : ./GNG_WF.py
* _CE_CONDA : 
* _CE_M : 
* __CFBundleIdentifier : com.apple.Terminal

